Program.Sub.ScreenSU.Start
Gui.F_WO..Create
Gui.F_WO..Caption("Open Work Order Project/Phase Dashboard")
Gui.F_WO..Size(16590,11490)
Gui.F_WO..MinX(15375)
Gui.F_WO..MinY(11490)
Gui.F_WO..Position(0,0)
Gui.F_WO..BackColor(-2147483633)
Gui.F_WO..MousePointer(0)
Gui.F_WO..Event(UnLoad,Form_UnLoad)
Gui.F_WO..Event(Resize,F_WO_Resize)
Gui.F_WO.frameFilters.Create(Frame)
Gui.F_WO.frameFilters.Size(8355,915)
Gui.F_WO.frameFilters.Position(90,10050)
Gui.F_WO.frameFilters.Caption("Filters")
Gui.F_WO.frameFilters.Visible(False)
Gui.F_WO.frameFilters.Enabled(False)
Gui.F_WO.cmdFilter.Create(Button)
Gui.F_WO.cmdFilter.Size(855,675)
Gui.F_WO.cmdFilter.Position(7425,180)
Gui.F_WO.cmdFilter.Parent("frameFilters")
Gui.F_WO.cmdFilter.Caption("Filter")
Gui.F_WO.cmdFilter.Event(Click,cmdFilter_Click)
Gui.F_WO.chkCust.Create(CheckBox)
Gui.F_WO.chkCust.Size(1110,255)
Gui.F_WO.chkCust.Position(195,270)
Gui.F_WO.chkCust.Parent("frameFilters")
Gui.F_WO.chkCust.Caption("Customer:")
Gui.F_WO.txtCust.Create(TextBox,"",True,2400,300,0,195,540,True,0,"Arial",8,-2147483643,1)
Gui.F_WO.txtCust.Parent("frameFilters")
Gui.F_WO.cmdCust.Create(Button)
Gui.F_WO.cmdCust.Size(345,330)
Gui.F_WO.cmdCust.Position(2640,525)
Gui.F_WO.cmdCust.Parent("frameFilters")
Gui.F_WO.cmdCust.Caption("^")
Gui.F_WO.cmdCust.Event(Click,cmdCust_Click)
Gui.F_WO.txtLoc.Create(TextBox,"",True,495,300,0,3090,540,True,0,"Arial",8,-2147483643,1)
Gui.F_WO.txtLoc.Parent("frameFilters")
Gui.F_WO.cmdLoc.Create(Button)
Gui.F_WO.cmdLoc.Size(345,330)
Gui.F_WO.cmdLoc.Position(3615,525)
Gui.F_WO.cmdLoc.Parent("frameFilters")
Gui.F_WO.cmdLoc.Caption("^")
Gui.F_WO.cmdLoc.Event(Click,cmdLoc_Click)
Gui.F_WO.chkLoc.Create(CheckBox)
Gui.F_WO.chkLoc.Size(690,270)
Gui.F_WO.chkLoc.Position(3090,270)
Gui.F_WO.chkLoc.Parent("frameFilters")
Gui.F_WO.chkLoc.Caption("Loc:")
Gui.F_WO.chkProj.Create(CheckBox)
Gui.F_WO.chkProj.Size(945,255)
Gui.F_WO.chkProj.Position(4065,270)
Gui.F_WO.chkProj.Parent("frameFilters")
Gui.F_WO.chkProj.Caption("Project:")
Gui.F_WO.chkProj.BackColor(15790320)
Gui.F_WO.chkProj.ForeColor(0)
Gui.F_WO.txtProj.Create(TextBox,"",True,1185,300,0,4065,525,True,0,"Arial",8,-2147483643,1)
Gui.F_WO.txtProj.Parent("frameFilters")
Gui.F_WO.txtProj.ForeColor(0)
Gui.F_WO.cmdProj.Create(Button)
Gui.F_WO.cmdProj.Size(345,330)
Gui.F_WO.cmdProj.Position(5295,525)
Gui.F_WO.cmdProj.Parent("frameFilters")
Gui.F_WO.cmdProj.Caption("^")
Gui.F_WO.cmdProj.Event(Click,cmdProject_Click)
Gui.F_WO.txtPhase.Create(TextBox,"",True,1155,300,0,5745,525,True,0,"Arial",8,-2147483643,1)
Gui.F_WO.txtPhase.Parent("frameFilters")
Gui.F_WO.txtPhase.ForeColor(0)
Gui.F_WO.cmdPhase.Create(Button)
Gui.F_WO.cmdPhase.Size(345,330)
Gui.F_WO.cmdPhase.Position(6945,525)
Gui.F_WO.cmdPhase.Parent("frameFilters")
Gui.F_WO.cmdPhase.Caption("^")
Gui.F_WO.cmdPhase.Event(Click,cmdPhase_Click)
Gui.F_WO.chkPhase.Create(CheckBox)
Gui.F_WO.chkPhase.Size(870,255)
Gui.F_WO.chkPhase.Position(5745,255)
Gui.F_WO.chkPhase.Parent("frameFilters")
Gui.F_WO.chkPhase.Caption("Phase:")
Gui.F_WO.chkPhase.BackColor(15790320)
Gui.F_WO.chkPhase.ForeColor(0)
Gui.F_WO.frameTot.Create(Frame)
Gui.F_WO.frameTot.Size(3915,855)
Gui.F_WO.frameTot.Position(12465,10050)
Gui.F_WO.lblRemHrs.Create(Label,"Tot Rem Hrs",True,1005,255,0,2760,195,True,0,"Arial",8,-2147483633,0)
Gui.F_WO.lblRemHrs.Parent("frameTot")
Gui.F_WO.lblActHrs.Create(Label,"Tot Act Hrs",True,960,255,0,1515,195,True,0,"Arial",8,-2147483633,0)
Gui.F_WO.lblActHrs.Parent("frameTot")
Gui.F_WO.lblEstHrs.Create(Label,"Tot Est Hrs",True,960,255,0,240,195,True,0,"Arial",8,-2147483633,0)
Gui.F_WO.lblEstHrs.Parent("frameTot")
Gui.F_WO.txtRemHrs.Create(TextBox,"",True,1200,300,0,2670,420,True,2,"Arial",8,-2147483643,1)
Gui.F_WO.txtRemHrs.Parent("frameTot")
Gui.F_WO.txtRemHrs.Locked(True)
Gui.F_WO.txtActHrs.Create(TextBox,"",True,1200,300,0,1395,420,True,2,"Arial",8,-2147483643,1)
Gui.F_WO.txtActHrs.Parent("frameTot")
Gui.F_WO.txtActHrs.Locked(True)
Gui.F_WO.txtEstHrs.Create(TextBox,"",True,1200,300,0,120,420,True,2,"Arial",8,-2147483643,1)
Gui.F_WO.txtEstHrs.Parent("frameTot")
Gui.F_WO.txtEstHrs.Locked(True)
Gui.F_WO.progressBarStatus.Create(ProgressBar)
Gui.F_WO.progressBarStatus.Size(4110,255)
Gui.F_WO.progressBarStatus.Position(90,330)
Gui.F_WO.progressBarStatus.Visible(False)
Gui.F_WO.lblStatus.Create(Label,"****Change****",False,4110,255,0,90,105,True,0,"Arial",10,-2147483633,0)
Gui.F_WO.picGSSLogo.Create(PictureBox)
Gui.F_WO.picGSSLogo.Size(4125,960)
Gui.F_WO.picGSSLogo.Position(4335,45)
Gui.F_WO.picGSSLogo.Event(DblClick,picGSSLogo_DblClick)
Gui.F_WO.framePermissions.Create(Frame)
Gui.F_WO.framePermissions.Size(1965,390)
Gui.F_WO.framePermissions.Position(14355,570)
Gui.F_WO.optView.Create(Option)
Gui.F_WO.optView.Size(690,195)
Gui.F_WO.optView.Position(225,150)
Gui.F_WO.optView.Caption("View")
Gui.F_WO.optView.BackColor(15790320)
Gui.F_WO.optView.ForeColor(0)
Gui.F_WO.optView.Parent("framePermissions")
Gui.F_WO.optEdit.Create(Option)
Gui.F_WO.optEdit.Enabled(False)
Gui.F_WO.optEdit.Size(690,195)
Gui.F_WO.optEdit.Position(1050,150)
Gui.F_WO.optEdit.Caption("Edit")
Gui.F_WO.optEdit.Parent("framePermissions")
Gui.F_WO.frameButtons.Create(Frame)
Gui.F_WO.frameButtons.Size(7635,600)
Gui.F_WO.frameButtons.Position(8685,60)
Gui.F_WO.cmdExport.Create(Button)
Gui.F_WO.cmdExport.Size(840,375)
Gui.F_WO.cmdExport.Position(5610,150)
Gui.F_WO.cmdExport.Caption("Export")
Gui.F_WO.cmdExport.Event(Click,cmdExport_Click)
Gui.F_WO.cmdExport.Parent("frameButtons")
Gui.F_WO.cmdRefresh.Create(Button)
Gui.F_WO.cmdRefresh.Size(840,375)
Gui.F_WO.cmdRefresh.Position(60,150)
Gui.F_WO.cmdRefresh.Caption("REFRESH")
Gui.F_WO.cmdRefresh.Event(Click,cmdRefresh_Click)
Gui.F_WO.cmdRefresh.Parent("frameButtons")
Gui.F_WO.cmdPrint.Create(Button)
Gui.F_WO.cmdPrint.Size(855,390)
Gui.F_WO.cmdPrint.Position(4710,135)
Gui.F_WO.cmdPrint.Caption("Print PL")
Gui.F_WO.cmdPrint.Event(Click,cmdPrint_Click)
Gui.F_WO.cmdPrint.Parent("frameButtons")
Gui.F_WO.cmdClrFlt.Create(Button)
Gui.F_WO.cmdClrFlt.Size(990,390)
Gui.F_WO.cmdClrFlt.Position(3660,135)
Gui.F_WO.cmdClrFlt.Parent("frameButtons")
Gui.F_WO.cmdClrFlt.Caption("Clear Filter")
Gui.F_WO.cmdClrFlt.Event(Click,cmdClrFlt_Click)
Gui.F_WO.cmdSrtWoSuf.Create(Button)
Gui.F_WO.cmdSrtWoSuf.Size(1590,390)
Gui.F_WO.cmdSrtWoSuf.Position(960,135)
Gui.F_WO.cmdSrtWoSuf.Parent("frameButtons")
Gui.F_WO.cmdSrtWoSuf.Caption("Sort by WO, Suffix")
Gui.F_WO.cmdSrtWoSuf.Event(Click,cmdSrtWoSuf_Click)
Gui.F_WO.CmdClrSrt.Create(Button)
Gui.F_WO.CmdClrSrt.Size(990,390)
Gui.F_WO.CmdClrSrt.Position(2610,135)
Gui.F_WO.CmdClrSrt.Parent("frameButtons")
Gui.F_WO.CmdClrSrt.Caption("Clear Sort")
Gui.F_WO.CmdClrSrt.Event(Click,CmdClrSrt_Click)
Gui.F_WO.cmdSchedule.Create(Button)
Gui.F_WO.cmdSchedule.Size(1080,375)
Gui.F_WO.cmdSchedule.Position(6495,150)
Gui.F_WO.cmdSchedule.Caption("Reschedule")
Gui.F_WO.cmdSchedule.Event(Click,cmd1_Click)
Gui.F_WO.cmdSchedule.Anchor(9)
Gui.F_WO.cmdSchedule.Enabled(False)
Gui.F_WO.cmdSchedule.Parent("frameButtons")
Gui.F_WO.GsGCWO.Create(GsGridControl)
Gui.F_WO.GsGCWO.Size(16245,9015)
Gui.F_WO.GsGCWO.Position(90,1035)
Gui.F_WO.GsGCWO.Event(RowCellClick,GsGCWO_RowCellClick)
Gui.F_WO.GsGCWO.Event(CellValueChanged,GsGCWO_CellValueChanged)
Gui.F_WO.GsGCWO.Event(ColumnFilterChanged,GsGCWO_ColumnFilterChanged)
Gui.frmWeb..Create
Gui.frmWeb..Caption("Global Shop Solutions - Web Sites")
Gui.frmWeb..Size(4035,1695)
Gui.frmWeb..MinX(0)
Gui.frmWeb..MinY(0)
Gui.frmWeb..Position(0,0)
Gui.frmWeb..BackColor(-2147483633)
Gui.frmWeb..MousePointer(0)
Gui.frmWeb..MaxButton(False)
Gui.frmWeb..Sizeable(False)
Gui.frmWeb..Event(UnLoad,frmWeb_UnLoad)
Gui.frmWeb..MinButton(False)
Gui.frmWeb.cmdGSS.Create(Button)
Gui.frmWeb.cmdGSS.Size(3615,375)
Gui.frmWeb.cmdGSS.Position(120,45)
Gui.frmWeb.cmdGSS.Caption("Global Shop Solutions")
Gui.frmWeb.cmdGSS.Event(Click,cmdGSS_Click)
Gui.frmWeb.cmdServ.Create(Button)
Gui.frmWeb.cmdServ.Size(3615,375)
Gui.frmWeb.cmdServ.Position(120,450)
Gui.frmWeb.cmdServ.Caption("ServiceWeb")
Gui.frmWeb.cmdServ.Event(Click,cmdServ_Click)
Gui.frmWeb.cmdUpd.Create(Button)
Gui.frmWeb.cmdUpd.Size(3615,375)
Gui.frmWeb.cmdUpd.Position(120,855)
Gui.frmWeb.cmdUpd.Caption("GSS Updates")
Gui.frmWeb.cmdUpd.Event(Click,cmdUpd_Click)
Gui.frmEntry..Create
Gui.frmEntry..Caption("Data entry")
Gui.frmEntry..Size(4725,8115)
Gui.frmEntry..MinX(0)
Gui.frmEntry..MinY(0)
Gui.frmEntry..Position(0,0)
Gui.frmEntry..BackColor(-2147483633)
Gui.frmEntry..MaxButton(False)
Gui.frmEntry..MinButton(False)
Gui.frmEntry..MousePointer(0)
Gui.frmEntry..Event(UnLoad,frmEntry_UnLoad)
Gui.frmEntry.lbl1.Create(Label,"ShipToLoc :",True,1185,255,0,120,225,True,0,"Arial",8,-2147483633,0)
Gui.frmEntry.lbl2.Create(Label,"ShipDate :",True,1185,255,0,120,645,True,0,"Arial",8,-2147483633,0)
Gui.frmEntry.lbl3.Create(Label,"Customer PO :",True,1185,255,0,105,1500,True,0,"Arial",8,-2147483633,0)
Gui.frmEntry.lbl4.Create(Label,"Shipping Rep :",True,1185,255,0,120,1080,True,0,"Arial",8,-2147483633,0)
Gui.frmEntry.lbl5.Create(Label,"Shipped Via :",True,1185,255,0,120,2385,True,0,"Arial",8,-2147483633,0)
Gui.frmEntry.lbl6.Create(Label,"Cartons :",True,1185,255,0,120,2775,True,0,"Arial",8,-2147483633,0)
Gui.frmEntry.lbl7.Create(Label,"Weight :",True,1185,255,0,120,3255,True,0,"Arial",8,-2147483633,0)
Gui.frmEntry.lbl8.Create(Label,"Waybill Number :",True,1395,255,0,120,3735,True,0,"Arial",8,-2147483633,0)
Gui.frmEntry.lbl9.Create(Label,"Mark Shipment :",True,1335,255,0,120,1950,True,0,"Arial",8,-2147483633,0)
Gui.frmEntry.ddlShipto.Create(DropDownList)
Gui.frmEntry.ddlShipto.Size(1185,330)
Gui.frmEntry.ddlShipto.Position(1530,165)
Gui.frmEntry.lbl10.Create(Label,"Pklst No :",True,1395,255,0,135,4200,True,0,"Arial",8,-2147483633,0)
Gui.frmEntry.lbl11.Create(Label,"Comments :",True,1395,255,0,135,4680,True,0,"Arial",8,-2147483633,0)
Gui.frmEntry.dtShipdt.Create(DatePicker)
Gui.frmEntry.dtShipdt.Size(1185,285)
Gui.frmEntry.dtShipdt.Position(1530,585)
Gui.frmEntry.txtShipRep.Create(TextBox,"",True,1905,300,0,1530,1020,True,0,"Arial",8,-2147483643,1)
Gui.frmEntry.txtCustPO.Create(TextBox,"",True,1905,300,0,1530,1440,True,0,"Arial",8,-2147483643,1)
Gui.frmEntry.txtCustPO.MaxLength(20)
Gui.frmEntry.txtMarkShip.Create(TextBox,"",True,1905,300,0,1530,1890,True,0,"Arial",8,-2147483643,1)
Gui.frmEntry.txtMarkShip.MaxLength(20)
Gui.frmEntry.txtshipVia.Create(TextBox,"",True,1905,300,0,1530,2325,True,0,"Arial",8,-2147483643,1)
Gui.frmEntry.txtshipVia.MaxLength(20)
Gui.frmEntry.txtCartons.Create(TextBox,"",True,1905,300,0,1530,2760,True,0,"Arial",8,-2147483643,1)
Gui.frmEntry.txtWt.Create(TextBox,"",True,1905,300,0,1530,3210,True,0,"Arial",8,-2147483643,1)
Gui.frmEntry.txtWaybill.Create(TextBox,"",True,1905,300,0,1530,3660,True,0,"Arial",8,-2147483643,1)
Gui.frmEntry.txtWaybill.MaxLength(20)
Gui.frmEntry.txtPklst.Create(TextBox,"",True,1905,300,0,1530,4110,True,0,"Arial",8,-2147483643,1)
Gui.frmEntry.txtcomments.Create(TextboxM)
Gui.frmEntry.txtcomments.Size(4110,1980)
Gui.frmEntry.txtcomments.Position(135,4950)
Gui.frmEntry.txtcomments.MaxLength(500)
Gui.frmEntry.cmdOk.Create(Button)
Gui.frmEntry.cmdOk.Size(855,375)
Gui.frmEntry.cmdOk.Position(135,7110)
Gui.frmEntry.cmdOk.Caption("OK")
Gui.frmEntry.cmdOk.Event(Click,cmdOk_Click)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
	V.Global.sCustomer.Declare(String)
	V.Global.sFilter.Declare(String)
	v.Global.sOrdinal.Declare(String)
Program.Sub.Preflight.End

Program.Sub.Main.Start
	V.Local.sIcon.Declare
	V.Local.sGssLogo.Declare
	V.Local.bEditWO.Declare
	'This was originally a dashboard created by Service. Project called GAB_4253_PMWO_Status.g2u. Modified by FEQ for Dover MEI on Jan 16, 2018. Added a column between O Status and Part for the user to add notes to.

	F.Intrinsic.String.Build("{0}\GAB\GAS\gss2.ico",V.Caller.PluginsDir,v.Local.sIcon)
	F.Intrinsic.String.Build("{0}\GAB\GAS\GAB_GSS_Logo_Green_Dash.png",V.Caller.PluginsDir,V.Local.sGssLogo)
	Gui.frmWeb..Icon(V.Local.sIcon)
	Gui.F_WO..Icon(V.Local.sIcon)
	Gui.F_WO.picGSSLogo.Picture(V.Local.sGssLogo)

	Gui.F_WO.optView.Value(True)
	Gui.F_WO.optEdit.Value(False)
	F.Intrinsic.Control.CallSub(setanchors)
'	F.Intrinsic.Control.CallSub(checkpermissions)
	F.Global.Security.IsInGroup(V.Caller.User,"EditWO",V.Caller.CompanyCode,V.Local.bEditWO)
	F.Intrinsic.Control.If(V.Local.bEditWO)
		Gui.F_WO.optEdit.Enabled(True)
		gui.F_WO.cmdSchedule.Enabled(True)
	F.Intrinsic.Control.EndIf
	
	gui.frmEntry.ddlShipto.AddItem("")
	gui.frmEntry.ddlShipto.AddItem("TX")
	gui.frmEntry.ddlShipto.AddItem("SC")
		
	Gui.F_WO..Show
	F.ODBC.Connection!con.OpenConnection(V.Ambient.PDSN,V.Ambient.PUser,V.Ambient.PPass,2000)
	F.Intrinsic.Control.CallSub(lockscreen)
	F.Intrinsic.Control.CallSub(checktable)
	F.Intrinsic.Control.CallSub(loaddtdvwos)
	F.Intrinsic.Control.CallSub(loadgvwos)
	F.Intrinsic.Control.CallSub(loaddtdvgvmatl)
	F.Intrinsic.Control.CallSub(loaddtdvgvlbr)
	F.Intrinsic.Control.CallSub(loaddtdvgvout)
'	F.Intrinsic.Control.CallSub(loadtotals,"Filter","JOB LIKE '%%'")
	'Remove indirect Jobs
	F.Intrinsic.Control.CallSub(loadtotals,"Filter","JOB LIKE '%%' AND IND_FLAG <> True")
	f.Intrinsic.Control.CallSub(update_status)
	F.Intrinsic.Control.CallSub(Formatting)
	F.Intrinsic.Control.CallSub(enablescreen)
	F.Intrinsic.Control.CallSub(Deserialize)
	
Program.Sub.Main.End

Program.Sub.Update_Status.Start
'BN May 22, 2017
F.Intrinsic.Control.SetErrorHandler("Update_Status_Err")
F.Intrinsic.Control.ClearErrors

V.Local..BulkDeclareString(sError, sJBSF, sFilter,sStatus)
v.Local..BulkDeclareLong(iC,iCounter)
v.Local..BulkDeclareBoolean(bPositiveQtyRem, bPO_Blank, bMatl, bOut)

f.Intrinsic.UI.InvokeWaitDialog("Update  M Status")
F.Intrinsic.Control.For(V.Local.iC,0,V.DataTable.dtWOs.RowCount--,1)
	
	V.Local.sJBSF.Set(V.DataTable.dtWOs(V.Local.iC).JS!FieldVal)
	
	F.Intrinsic.Control.If(V.DataView.dtWOs!dvStatusWOs.Exists)
		F.Data.DataView.Close("dtWOs$dtMatl","dvStatusWOs")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.String.Build("JBSF = '{0}'",V.Local.sJBSF,V.Local.sFilter)
	F.Data.DataView.Create("dtWOs$dtMatl","dvStatusWOs",22,V.Local.sFilter,"JBSF ASC")		
	v.Local.sStatus.Set("R")
	v.Local.bPO_Blank.Set(False)
	v.Local.bPositiveQtyRem.Set(False)
	'
	'Variable.DataView.datatablename!dataviewname.property
	f.Intrinsic.Control.If(V.DataView.dtWOs$dtMatl!dvStatusWOs.RowCount,=,0)
		v.Local.sStatus.Set("N")
	f.Intrinsic.Control.Else
	
		f.Intrinsic.Control.For(v.Local.iCounter,0, V.DataView.dtWOs$dtMatl!dvStatusWOs.RowCount--,1)
			'Variable.DataView.datatablename!dataviewname(row number).fieldname!property
	
			f.Intrinsic.Control.If(Variable.DataView.dtWOs$dtMatl!dvStatusWOs(v.Local.iCounter).PCSREMAIN!FieldValFloat,>,0)
				v.Local.bPositiveQtyRem.Set(True)
			f.Intrinsic.Control.EndIf
			
			f.Intrinsic.Control.If(Variable.DataView.dtWOs$dtMatl!dvStatusWOs(v.Local.iCounter).PURCHASE_ORDER!FieldValTrim,=,"")
'				f.Intrinsic.Control.If(Variable.DataView.dtWOs$dtMatl!dvStatusWOs(v.Local.iCounter).PCSREMAIN!FieldValFloat,=,0)
					v.Local.bPO_Blank.Set(True)
				f.Intrinsic.Control.Else
					v.Local.bPO_Blank.Set(False)
'				f.Intrinsic.Control.EndIf
			f.Intrinsic.Control.EndIf			

		f.Intrinsic.Control.Next(v.Local.iCounter)
	f.Intrinsic.Control.EndIf
		f.Intrinsic.Control.If(V.DataView.dtWOs$dtMatl!dvStatusWOs.RowCount,=,0)
			v.Local.sStatus.Set("N")
		f.Intrinsic.Control.Else	
			f.Intrinsic.Control.If(v.Local.bPositiveQtyRem,=,True)
				f.Intrinsic.Control.If(v.Local.bPO_Blank,=,True)
					v.Local.sStatus.Set("")
				f.Intrinsic.Control.Else
					v.Local.sStatus.Set("P")
				f.Intrinsic.Control.EndIf
		
			f.Intrinsic.Control.Else
				v.Local.sStatus.Set("R")		
			f.Intrinsic.Control.EndIf
		f.Intrinsic.Control.EndIf
	
	F.Data.DataTable.SetValue("dtWOs",V.Local.iC,"Status",v.Local.sStatus)		

	
F.Intrinsic.Control.Next(V.Local.iC)


f.Intrinsic.UI.CloseWaitDialog


f.Intrinsic.UI.InvokeWaitDialog("Update  O Status")
F.Intrinsic.Control.For(V.Local.iC,0,V.DataTable.dtWOs.RowCount--,1)
	
	V.Local.sJBSF.Set(V.DataTable.dtWOs(V.Local.iC).JS!FieldVal)
	
	F.Intrinsic.Control.If(V.DataView.dtWOs!dvStatusWOs1.Exists)
		F.Data.DataView.Close("dtWOs$dtOut","dvStatusWOs1")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.String.Build("JBSF = '{0}'",V.Local.sJBSF,V.Local.sFilter)
	F.Data.DataView.Create("dtWOs$dtOut","dvStatusWOs1",22,V.Local.sFilter,"JBSF ASC")		
	v.Local.sStatus.Set("R")
	v.Local.bPO_Blank.Set(False)
	v.Local.bPositiveQtyRem.Set(False)
	'
	'Variable.DataView.datatablename!dataviewname.property
	f.Intrinsic.Control.If(V.DataView.dtWOs$dtOut!dvStatusWOs1.RowCount,=,0)
		v.Local.sStatus.Set("N")
	f.Intrinsic.Control.Else
		f.Intrinsic.Control.For(v.Local.iCounter,0, V.DataView.dtWOs$dtOut!dvStatusWOs1.RowCount--,1)
			'Variable.DataView.datatablename!dataviewname(row number).fieldname!property
	
			f.Intrinsic.Control.If(Variable.DataView.dtWOs$dtOut!dvStatusWOs1(v.Local.iCounter).PCSREMAIN!FieldValFloat,>,0)
				v.Local.bPositiveQtyRem.Set(True)
			f.Intrinsic.Control.EndIf
			
			f.Intrinsic.Control.If(Variable.DataView.dtWOs$dtOut!dvStatusWOs1(v.Local.iCounter).PURCHASE_ORDER1!FieldValTrim,=,"")
				v.Local.bPO_Blank.Set(True)
			f.Intrinsic.Control.EndIf			
		
		f.Intrinsic.Control.Next(v.Local.iCounter)
	f.Intrinsic.Control.EndIf
	f.Intrinsic.Control.If(V.DataView.dtWOs$dtOut!dvStatusWOs1.RowCount,=,0)
		v.Local.sStatus.Set("N")
	f.Intrinsic.Control.Else
		f.Intrinsic.Control.If(v.Local.bPositiveQtyRem,=,True)
			f.Intrinsic.Control.If(v.Local.bPO_Blank,=,True)
				v.Local.sStatus.Set("")	
			f.Intrinsic.Control.Else
				v.Local.sStatus.Set("P")
			f.Intrinsic.Control.EndIf
		
		f.Intrinsic.Control.Else
			v.Local.sStatus.Set("R")		
		f.Intrinsic.Control.EndIf
	f.Intrinsic.Control.EndIf
	
	F.Data.DataTable.SetValue("dtWOs",V.Local.iC,"OStatus",v.Local.sStatus)		

	
F.Intrinsic.Control.Next(V.Local.iC)


f.Intrinsic.UI.CloseWaitDialog


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Update_Status_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GAB_4253_PMWO_Status.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf


Program.Sub.Update_Status.End

Program.Sub.CheckPermissions.Start
	V.Local.bEditWO.Declare
	
	'New WO
	F.Global.Security.CheckUserAccessIPM(636,527,V.Local.bEditWO)
	F.Intrinsic.Control.If(V.Local.bEditWO,=,False)
		'Open WO
		F.Global.Security.CheckUserAccessIPM(635,527,V.Local.bEditWO)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Local.bEditWO,=,True)
		Gui.F_WO.optEdit.Enabled(True)
	F.Intrinsic.Control.EndIf
Program.Sub.CheckPermissions.End

Program.Sub.Form_UnLoad.Start
F.Intrinsic.Control.CallSub(serialize)
	F.ODBC.Connection!con.Close
	F.Intrinsic.Control.End

Program.Sub.Form_UnLoad.End

Program.Sub.LoadDTDVWOs.Start
	V.Local.iCnt.Declare(Long)
	V.Local.iProgress.Declare(Long)
	V.Local.sSQL.Declare(String)
	V.Local.sRet.Declare(String)
	V.Local.sJob.Declare(String)
	V.Local.sSuffix.Declare(String)
	V.Local.fEstHrs.Declare(Float)
	V.Local.fRemHrs.Declare(Float)
	V.Local.fPcsRem.Declare(Float)
	V.Local.sOper.Declare(String)
	V.Local.bDictExists.Declare

	F.Intrinsic.Control.If(V.DataTable.dtWOs.Exists,=,True)
		F.Data.DataTable.Close("dtWOs")
	F.Intrinsic.Control.EndIf
	
	F.Data.Dictionary.Exists("dIndirect",V.Local.bDictExists)
	F.Intrinsic.Control.If(V.Local.bDictExists,=,True)
		F.Data.Dictionary.Close("dIndirect")
	F.Intrinsic.Control.EndIf
	
	F.Data.Dictionary.CreateFromSQL("dIndirect","con","SELECT DISTINCT CONCAT(JOB,SUFFIX) AS JS,CONVERT(IF('' = '',1,0),SQL_BIT) FROM IND_LBR_ACCTS;")
	F.Data.Dictionary.SetDefaultReturn("dIndirect",False)
	

'	F.Data.DataTable.CreateFromSQL("dtWOs","con","SELECT CONVERT(CASE WHEN FLAG_WO_PRTD = 'Y' THEN 1 WHEN FLAG_WO_PRTD = 'X' THEN 0 WHEN FLAG_WO_PRTD = '' THEN 0 WHEN FLAG_WO_PRTD = 'R' THEN 1 END,SQL_BIT) AS PRINTED,CONVERT(CASE WHEN FLAG_WO_PRTD = 'Y' THEN 0 WHEN FLAG_WO_PRTD = 'X' THEN 1 WHEN FLAG_WO_PRTD = '' THEN 0 WHEN FLAG_WO_PRTD = 'R' THEN 1 END,SQL_BIT) AS RELEASED,JOB,SUFFIX,PROJECT,PHASE,DESCR,NAME_CUSTOMER,PART,LOCATION,PRODUCT_LINE,DESCRIPTION,DATE_START,DATE_DUE,NUM_HOURS AS ACT_HRS,QTY_ORDER,C.NOTES,CONCAT(JOB,SUFFIX) AS JS FROM V_JOB_HEADER A LEFT JOIN V_CUSTOMER_MASTER B ON A.CUSTOMER = B.CUSTOMER LEFT JOIN GAB_4135_WO_NOTES C ON A.JOB = C.JOB AND A.SUFFIX = C.SUFFIX LEFT JOIN PROJECT_MASTER D ON A.PROJECT = D.PROJECT WHERE DATE_CLOSED = '1900-1-1' ORDER BY DATE_DUE,JOB,SUFFIX;",True)
	F.Data.DataTable.CreateFromSQL("dtWOs","con","SELECT CONVERT(CASE WHEN A.FLAG_WO_PRTD = 'Y' THEN 1 WHEN A.FLAG_WO_PRTD = 'X' THEN 0 WHEN A.FLAG_WO_PRTD = '' THEN 0 WHEN A.FLAG_WO_PRTD = 'R' THEN 1 END,SQL_BIT) AS PRINTED,CONVERT(CASE WHEN A.FLAG_WO_PRTD = 'Y' THEN 0 WHEN A.FLAG_WO_PRTD = 'X' THEN 1 WHEN A.FLAG_WO_PRTD = '' THEN 0 WHEN A.FLAG_WO_PRTD = 'R' THEN 1 END,SQL_BIT) AS RELEASED,A.JOB,A.SUFFIX,D.PROJECT,A.PHASE,E.Qty_Shipped,D.DESCR,B.NAME_CUSTOMER,A.PART,A.LOCATION,A.PRODUCT_LINE,A.DESCRIPTION,A.DATE_START,A.DATE_DUE,A.NUM_HOURS AS ACT_HRS,A.QTY_ORDER, Rtrim(E.NOTES) as DashNotes,C.NOTES,CONCAT(A.JOB,A.SUFFIX) AS JS FROM V_JOB_HEADER A LEFT JOIN V_CUSTOMER_MASTER B ON A.CUSTOMER = B.CUSTOMER LEFT JOIN GAB_4135_WO_NOTES C ON A.JOB = C.JOB AND A.SUFFIX = C.SUFFIX LEFT JOIN PROJECT_MASTER D ON A.PROJECT = D.PROJECT LEFT JOIN GCG_4253_ShipDash E ON A.Job = E.Job and A.suffix = E.Suffix and A.PROJECT = E.PROJECT and A.Part = E.Part and A.Location = E.Loc WHERE A.DATE_CLOSED = '1900-1-1' ORDER BY A.DATE_DUE,A.JOB,A.SUFFIX;",True)
	F.Data.DataTable.AddColumn("dtWOs","EST_HRS",Float)
	F.Data.DataTable.AddColumn("dtWOs","REM_HRS",Float)
	F.Data.DataTable.AddColumn("dtWOs","OPER",String)
	F.Data.DataTable.AddColumn("dtWOs","PCS_REM",Long)
	F.Data.DataTable.AddColumn("dtWOs","+",String,"")
	F.Data.DataTable.AddColumn("dtWOs","IND_FLAG",Boolean)
	
	F.Data.DataTable.AddColumn("dtWOs","Status",string,"")
	F.Data.DataTable.AddColumn("dtWOs","OStatus",string,"")
	
	'-------------------RAN
	F.Data.DataTable.AddColumn("dtWOs","Qty_To_Ship",Long)
	'------------------------------
	
	Gui.F_WO.lblStatus.Visible(True)
	Gui.F_WO.progressBarStatus.Visible(True)
	Gui.F_WO.lblStatus.Caption("Loading Work Orders....")
	Gui.F_WO.progressBarStatus.Min(0)
	Gui.F_WO.progressBarStatus.Max(V.DataTable.dtWOs.RowCount)

	v.Local.sJS.Declare(string)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtWOs.RowCount--,1)
'	F.Intrinsic.Control.For(V.Local.iCnt,0,1,1)

'		f.Intrinsic.Control.If(v.Local.iCnt,=,0)
'			f.Intrinsic.String.Concat(v.Local.sJS,"'",Variable.DataTable.dtWOs(V.Local.iCnt).JS!FieldValString,"'",v.Local.sJS)		
'		f.Intrinsic.Control.Else
'			f.Intrinsic.String.Concat(v.Local.sJS,",'",Variable.DataTable.dtWOs(V.Local.iCnt).JS!FieldValString,"'",v.Local.sJS)
'		f.Intrinsic.Control.EndIf
		
		F.Intrinsic.Math.Add(V.Local.iProgress,1,V.Local.iProgress)
		Gui.F_WO.progressBarStatus.Value(V.Local.iProgress)
		V.Local.sJob.Set(V.DataTable.dtWOs(V.Local.iCnt).JOB!FieldVal)
		V.Local.sSuffix.Set(V.DataTable.dtWOs(V.Local.iCnt).SUFFIX!FieldVal)
		F.Intrinsic.String.Build("SELECT TOP 1 SEQTYPE,SEQRES,PCSREMAIN FROM APSV3_JBLINES WHERE COMPLDATE IS NULL AND JOB = '{0}' AND SFX = '{1}' ORDER BY JOB,SFX,SEQ;",V.Local.sJob,V.Local.sSuffix,V.Local.sSQL)
		F.ODBC.Connection!con.OpenLocalRecordsetRO("rstInfo",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstInfo.EOF,=,True)
				V.Local.sOper.Set("WipToFG")
				V.Local.FPcsRem.Set(0)
			F.Intrinsic.Control.Else
				V.Local.sOper.Set(V.ODBC.con!rstInfo.FieldValTrim!SEQRES)
				V.Local.fPcsRem.Set(V.ODBC.con!rstInfo.FieldValFloat!PCSREMAIN)
			F.Intrinsic.Control.EndIf
		F.ODBC.con!rstInfo.Close
		
		F.Intrinsic.String.Build("SELECT CONVERT(SUM(HOURSORIG+INITSU),SQL_NUMERIC) AS EST_HRS FROM APSV3_JBLINES WHERE SEQTYPE = '1' AND JOB = '{0}' AND SFX = '{1}' GROUP BY JOB,SFX;",V.Local.sJob,V.Local.sSuffix,V.Local.sSQL)
		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQL,V.Local.fEstHrs)

		F.Intrinsic.Control.If(V.Local.fEstHrs,=,0)
			V.Local.fEstHrs.Set(0.0000)
			V.Local.fRemHrs.Set(0.0000)
		F.Intrinsic.Control.Else
			F.Intrinsic.Math.Sub(V.Local.fEstHrs,V.DataTable.dtWOs(V.Local.iCnt).ACT_HRS!FieldValFloat,V.Local.fRemHrs)
		F.Intrinsic.Control.EndIf
		
		F.Data.DataTable.SetValue("dtWOs",V.Local.iCnt,"EST_HRS",V.Local.fEstHrs,"REM_HRS",V.Local.fRemHrs,"OPER",V.Local.sOper,"PCS_REM",V.Local.fPcsRem)
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
'	f.Intrinsic.String.Build("select Job_Suffix as JS,(CASE WHEN ltrim(rtrim(Customer_PO)) <> '' THEN 'P' WHEN ltrim(rtrim(Customer_PO))  = '' THEN '' End) as Status from V_GCG_4253 where JS in ({0})",v.Local.sJS,v.Local.sSQL)
'	F.Data.Dictionary.CreateFromSQL("StatusDict","con",v.Local.sSQL)
'	F.Data.Dictionary.SetDefaultReturn("StatusDict","")
	
	F.Data.DataTable.FillFromDictionary("dtWOs","dIndirect","JS","IND_FLAG")

'	F.Data.DataTable.FillFromDictionary("dtWOs","StatusDict","JS","Status")
	F.Data.DataTable.AddColumn("dtWOs", "Late", "String")
	'Add Parent Column
	v.Local.sSQL.Set("Select Job+Suffix as JS, Parent_WO+Parent_Suffix_Parent as Parent From Job_Header where Parent_WO != ''")
	F.Data.Dictionary.CreateFromSQL("Parent", "con", v.Local.sSQL)
	F.Data.DataTable.AddColumn("dtWOs", "Parent", "String")
	F.Data.DataTable.AddColumn("dtWOs", "ParentLate", "String")
	F.Data.Dictionary.SetDefaultReturn("Parent", "")
	F.Data.DataTable.FillFromDictionary("dtWOs", "Parent", "JS", "Parent")
	F.Data.Dictionary.Close("Parent")
	
'	F.Data.DataView.Create("dtWOs","dvWOs")
	'Remove indirect Jobs
	F.Data.DataView.Create("dtWOs","dvWOs",22,"IND_FLAG <> True","DATE_DUE ASC,JOB ASC,SUFFIX ASC")
	F.Data.Dictionary.Close("dIndirect")
Program.Sub.LoadDTDVWOs.End

Program.Sub.LoadGVWOs.Start
	V.Local.iRet.Declare
	V.Local.iCnt.Declare
	v.Local.bGroup.Declare
	

	Gui.F_WO.GsGCWO.AddGridViewFromDataView("gvWOs","dtWOs","dvWOs")
	
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvWOs","MultiSelect",True)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvWOs","AllowSort",True)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvWOs","AllowFilter",True)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvWOs","OptionsDetailShowDetailTabs",True)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvWOs","OptionsViewShowGroupPanel",True)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvWOs","EnableAppearanceOddRow",True)
'	Gui.F_WO.GsGCWO.SetGridViewProperty("gvWOs","OptionBehaviorEditable",True)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvWOs","OptionsViewColumnAutoWidth",False)
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","EST_HRS","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","ACT_HRS","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","REM_HRS","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","QTY_ORDER","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PCS_REM","DisplayCustomNumeric","#,###,###,##0.00")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","JS","Visible",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","IND_FLAG","Visible",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","+","ShowCaption",False)
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","+","VisibleIndex","0")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PRINTED","VisibleIndex","1")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","RELEASED","VisibleIndex","2")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","JOB","VisibleIndex","3")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","SUFFIX","VisibleIndex","4")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PROJECT","VisibleIndex","5")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PHASE","VisibleIndex","6")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","Status","VisibleIndex","7")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","OStatus","VisibleIndex","8")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DashNotes","VisibleIndex","9")	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PART","VisibleIndex","10")	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DESCRIPTION","VisibleIndex","11")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","OPER","VisibleIndex","12")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_START","VisibleIndex","13")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_DUE","VisibleIndex","14")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","QTY_ORDER","VisibleIndex","15")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PCS_REM","VisibleIndex","16")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","Qty_Shipped","VisibleIndex","17")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","Qty_To_Ship","VisibleIndex","18")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","ACT_HRS","VisibleIndex","19")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","EST_HRS","VisibleIndex","20")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","REM_HRS","VisibleIndex","21")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","NAME_CUSTOMER","VisibleIndex","22")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","NOTES","VisibleIndex","23")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PRINTED","Caption","Printed ")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","RELEASED","Caption","Released ")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","JOB","Caption","WO ")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","SUFFIX","Caption","Suffix ")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PROJECT","Caption","Project ")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PHASE","Caption","Phase ")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DESCR","Caption","Project Description")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","NAME_CUSTOMER","Caption","Cust. Name")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PART","Caption","Part ")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","LOCATION","Caption","Loc")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PRODUCT_LINE","Caption","PL")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DESCRIPTION","Caption","Description ")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_START","Caption","Start Date")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_DUE","Caption","Due Date")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","EST_HRS","Caption","Est. Hrs.")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","ACT_HRS","Caption","Act. Hrs.")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","REM_HRS","Caption","Rem. Hrs.")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","OPER","Caption","Current Operation")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","QTY_ORDER","Caption","Order Qty.")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PCS_REM","Caption","Pcs. Rem.")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DashNotes","Caption","FLOC")
'	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","Status","Caption","M Status")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","OStatus","Caption","O Status")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","NOTES","Caption","Notes")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","Qty_To_Ship","Caption","Qty To Ship")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","Qty_To_Ship","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","Qty_To_Ship","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","Qty_To_Ship","ReadOnly",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","Qty_To_Ship","AllowEdit",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","Qty_To_Ship","CellBackColor","LightYellow")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","Qty_Shipped","Caption","Qty Shipped")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","Qty_Shipped","MinWidth","85")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","Qty_Shipped","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","Qty_Shipped","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","Qty_Shipped","AllowEdit",False)
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","+","Fixed","Left")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PRINTED","Fixed","Left")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","RELEASED","Fixed","Left")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","JOB","Fixed","Left")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","SUFFIX","Fixed","Left")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PROJECT","Fixed","Left")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PHASE","Fixed","Left")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","+","MinWidth","0")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PRINTED","MinWidth","25")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","RELEASED","MinWidth","35")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","JOB","MinWidth","50")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","SUFFIX","MinWidth","25")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PROJECT","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PHASE","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DESCR","MinWidth","200")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","NAME_CUSTOMER","MinWidth","200")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","Status","MinWidth","50")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","OStatus","MinWidth","50")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DashNotes","MinWidth","35")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PART","MinWidth","150")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","LOCATION","MinWidth","35")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PRODUCT_LINE","MinWidth","35")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DESCRIPTION","MinWidth","200")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_START","MinWidth","100")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_DUE","MinWidth","100")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","EST_HRS","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","ACT_HRS","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","REM_HRS","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","OPER","MinWidth","200")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","QTY_ORDER","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PCS_REM","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","NOTES","MinWidth","300")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PRINTED","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","RELEASED","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","JOB","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","SUFFIX","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","LOCATION","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PRODUCT_LINE","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_START","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_DUE","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","EST_HRS","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","ACT_HRS","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","REM_HRS","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","QTY_ORDER","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PCS_REM","HeaderHAlignment","Center")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PRINTED","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","RELEASED","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","JOB","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","SUFFIX","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","LOCATION","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PRODUCT_LINE","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_START","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_DUE","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","EST_HRS","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","ACT_HRS","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","REM_HRS","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","QTY_ORDER","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PCS_REM","CellHAlignment","Center")

	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PRINTED","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","JOB","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","SUFFIX","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PROJECT","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PHASE","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DESCR","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","NAME_CUSTOMER","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PART","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","LOCATION","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PRODUCT_LINE","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DESCRIPTION","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_START","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_DUE","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","EST_HRS","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","ACT_HRS","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","REM_HRS","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","OPER","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","QTY_ORDER","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PCS_REM","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","NOTES","ReadOnly",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DashNotes","ReadOnly",False)

		
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PRINTED","AllowEdit",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","RELEASED","AllowEdit",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","JOB","AllowEdit",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","SUFFIX","AllowEdit",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PROJECT","AllowEdit",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PHASE","AllowEdit",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DESCR","AllowEdit",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","NAME_CUSTOMER","AllowEdit",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PART","AllowEdit",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","LOCATION","AllowEdit",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PRODUCT_LINE","AllowEdit",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DESCRIPTION","AllowEdit",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_START","AllowEdit",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_DUE","AllowEdit",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","EST_HRS","AllowEdit",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","ACT_HRS","AllowEdit",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","REM_HRS","AllowEdit",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","OPER","AllowEdit",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","QTY_ORDER","AllowEdit",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PCS_REM","AllowEdit",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","NOTES","AllowEdit",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DashNotes","AllowEdit",True)
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DashNotes","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","NOTES","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PCS_REM","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","QTY_ORDER","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","OPER","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","REM_HRS","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","ACT_HRS","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","EST_HRS","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_DUE","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_START","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DESCRIPTION","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PRODUCT_LINE","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","LOCATION","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PART","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","NAME_CUSTOMER","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DESCR","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PHASE","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PROJECT","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","SUFFIX","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","JOB","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","RELEASED","AllowSize",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PRINTED","AllowSize",True)
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","NOTES","CellBackColor","LightYellow")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DashNotes","CellBackColor","LightYellow")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","JOB","CellForeColor","Blue")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","SUFFIX","CellForeColor","Blue")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PART","CellForeColor","Blue")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","LOCATION","CellForeColor","Blue")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_START","DisplayCustomDatetime","d")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_DUE","DisplayCustomDatetime","d")
		'Check here to see if in Security Group
	F.Global.Security.IsInGroup(v.Caller.User, "EditWO",v.Caller.CompanyCode, v.Local.bGroup)
	F.Intrinsic.Control.If(v.Local.bGroup)
		Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_DUE","ReadOnly",False)
		Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_DUE","AllowEdit",True)
	F.Intrinsic.Control.Else
		Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_DUE","ReadOnly",True)
		Gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","DATE_DUE","AllowEdit",False)
	F.Intrinsic.Control.EndIf
	
	
	f.intrinsic.Control.If(v.global.sFilter.Trim,<>,"")
		Gui.F_WO.GsGCWO.SetGridViewProperty("gvWOs","ActiveFilterString",v.Global.sFilter)
	f.Intrinsic.Control.EndIf
	Gui.F_WO.GsGCWO.MainView("gvWOs")
	Gui.F_WO.GsGCWO.ResumeLayout()
Program.Sub.LoadGVWOs.End

Program.Sub.GsGCWO_RowCellClick.Start
	V.Local.sParams.Declare(String)
	V.Local.sJob.Declare(String)
	V.Local.sSuffix.Declare(String)
	V.Local.sPart.Declare(String)
	V.Local.sLoc.Declare(String)
	V.Local.sPO.Declare(String)
	V.Local.iColIx.Declare(Long)


	F.Intrinsic.Control.If(V.Screen.F_WO!optView.Value,=,True)
		F.Intrinsic.Control.SelectCase(V.Args.COLUMN)
			F.Intrinsic.Control.CaseAny("JOB","SUFFIX")
				F.Intrinsic.Control.CallSub(lockscreen)
				Gui.F_WO.GsGCWO.GetCellValue("gvWOs",2,V.Args.RowIndex,V.Local.sJob)
				Gui.F_WO.GsGCWO.GetCellValue("gvWOs",3,V.Args.RowIndex,V.Local.sSuffix)
				F.Intrinsic.String.Build("7!*!{0}!*!{1}!*!A",V.Local.sJob,V.Local.sSuffix,V.Local.sParams)
				F.Global.General.CallWrapperSync(450000,V.Local.sParams)
				Gui.F_WO.GsGCWO.Enabled(True)
				F.Intrinsic.Control.CallSub(enablescreen)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.CaseAny("PART","LOCATION")
				Gui.F_WO.GsGCWO.GetCellValue("gvWOs",8,V.Args.RowIndex,V.Local.sPart)
				Gui.F_WO.GsGCWO.GetCellValue("gvWOs",9,V.Args.RowIndex,V.Local.sLoc)
				F.Intrinsic.String.Build("{0}!*!{1}!*!O",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
				F.Intrinsic.Control.CallSub(lockscreen)
				F.Global.General.CallWrapperSync(300011,V.Local.sParams)
				Gui.F_WO.GsGCWO.Enabled(True)
				F.Intrinsic.Control.CallSub(enablescreen)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.Case("PRINTED")
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.Case("RELEASED")
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.CaseAny("PART1","LOCATION1")
				Gui.F_WO.GsGCWO.GetCellValue("gvMatl",5,V.Args.RowIndex,V.Local.sPart)
				Gui.F_WO.GsGCWO.GetCellValue("gvMatl",6,V.Args.RowIndex,V.Local.sLoc)
				F.Intrinsic.String.Build("{0}!*!{1}!*!O",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
				F.Intrinsic.Control.CallSub(lockscreen)
				F.Global.General.CallWrapperSync(300011,V.Local.sParams)
				Gui.F_WO.GsGCWO.Enabled(True)
				F.Intrinsic.Control.CallSub(enablescreen)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.Case("PURCHASE_ORDER")
				Gui.F_WO.GsGCWO.GetCellValue("gvMatl",9,V.Args.RowIndex,V.Local.sPO)
				F.Intrinsic.String.Build("V!*!{0}!*!",V.Local.sPO,V.Local.sParams)
				F.Intrinsic.Control.CallSub(lockscreen)
				F.Global.General.CallWrapperSync(175200,V.Local.sParams)
				Gui.F_WO.GsGCWO.Enabled(True)
				F.Intrinsic.Control.CallSub(enablescreen)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.Case("PURCHASE_ORDER1")
				Gui.F_WO.GsGCWO.GetColumnIndexByName("gvOut","PURCHASE_ORDER1",v.Local.iColIx)
				Gui.F_WO.GsGCWO.GetCellValue("gvOut",v.Local.iColIx,V.Args.RowIndex,V.Local.sPO)
				F.Intrinsic.String.Build("V!*!{0}!*!",V.Local.sPO,V.Local.sParams)
				F.Intrinsic.Control.CallSub(lockscreen)
				F.Global.General.CallWrapperSync(175200,V.Local.sParams)
				Gui.F_WO.GsGCWO.Enabled(True)
				F.Intrinsic.Control.CallSub(enablescreen)
				F.Intrinsic.Control.ExitSub
		F.Intrinsic.Control.EndSelect
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.SelectCase(V.Args.COLUMN)
			F.Intrinsic.Control.CaseAny("JOB","SUFFIX")
				F.Intrinsic.Control.CallSub(lockscreen)
				Gui.F_WO.GsGCWO.GetCellValue("gvWOs",2,V.Args.RowIndex,V.Local.sJob)
				Gui.F_WO.GsGCWO.GetCellValue("gvWOs",3,V.Args.RowIndex,V.Local.sSuffix)
				F.Intrinsic.String.Build("{0}!*!{1}!*!O",V.Local.sJob,V.Local.sSuffix,V.Local.sParams)
				F.Global.General.CallWrapperSync(2009,V.Local.sParams)
				Gui.F_WO.GsGCWO.Enabled(True)
				F.Intrinsic.Control.CallSub(enablescreen)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.CaseAny("PART","LOCATION")
				F.Intrinsic.Control.CallSub(lockscreen)
				Gui.F_WO.GsGCWO.GetCellValue("gvWOs",8,V.Args.RowIndex,V.Local.sPart)
				Gui.F_WO.GsGCWO.GetCellValue("gvWOs",9,V.Args.RowIndex,V.Local.sLoc)
				F.Intrinsic.String.Build("{0}!*!{1}!*!M",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
				F.Global.General.CallWrapperSync(300011,V.Local.sParams)
				Gui.F_WO.GsGCWO.Enabled(True)
				F.Intrinsic.Control.CallSub(enablescreen)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.Case("PRINTED")
				Gui.F_WO.GsGCWO.SetCellValue("gvWOs",0,V.Args.RowIndex,True)
				Gui.F_WO.GsGCWO.GetCellValue("gvWOs",2,V.Args.RowIndex,V.Local.sJob)
				Gui.F_WO.GsGCWO.GetCellValue("gvWOs",3,V.Args.RowIndex,V.Local.sSuffix)
				F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sJob,V.Local.sSuffix,"1811",V.Local.sParams)
				F.Global.General.CallWrapperSync(900100,V.Local.sParams)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.Case("RELEASED")
				Gui.F_WO.GsGCWO.SetCellValue("gvWOs",1,V.Args.RowIndex,True)
				Gui.F_WO.GsGCWO.GetCellValue("gvWOs",2,V.Args.RowIndex,V.Local.sJob)
				Gui.F_WO.GsGCWO.GetCellValue("gvWOs",3,V.Args.RowIndex,V.Local.sSuffix)
				F.Intrinsic.Control.CallSub(update_flag_wo_prtd,"JOB",V.Local.sJob,"SUFFIX",V.Local.sSuffix)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.CaseAny("PART1","LOCATION1")
				F.Intrinsic.Control.CallSub(lockscreen)
				Gui.F_WO.GsGCWO.GetCellValue("gvMatl",5,V.Args.RowIndex,V.Local.sPart)
				Gui.F_WO.GsGCWO.GetCellValue("gvMatl",6,V.Args.RowIndex,V.Local.sLoc)
				F.Intrinsic.String.Build("{0}!*!{1}!*!M",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
				F.Global.General.CallWrapperSync(300011,V.Local.sParams)
				Gui.F_WO.GsGCWO.Enabled(True)
				F.Intrinsic.Control.CallSub(enablescreen)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.Case("PURCHASE_ORDER")
				F.Intrinsic.Control.CallSub(lockscreen)

				Gui.F_WO.GsGCWO.GetCellValue("gvMatl",9,V.Args.RowIndex,V.Local.sPO)
				F.Intrinsic.String.Build("O!*!{0}!*!",V.Local.sPO,V.Local.sParams)
				F.Global.General.CallWrapperSync(175200,V.Local.sParams)
				Gui.F_WO.GsGCWO.Enabled(True)
				F.Intrinsic.Control.CallSub(enablescreen)
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.Case("PURCHASE_ORDER1")
				F.Intrinsic.Control.CallSub(lockscreen)
				Gui.F_WO.GsGCWO.GetColumnIndexByName("gvOut","PURCHASE_ORDER1",v.Local.iColIx)
				Gui.F_WO.GsGCWO.GetCellValue("gvOut",v.Local.iColIx,V.Args.RowIndex,V.Local.sPO)
				F.Intrinsic.String.Build("O!*!{0}!*!",V.Local.sPO,V.Local.sParams)
				F.Global.General.CallWrapperSync(175200,V.Local.sParams)
				Gui.F_WO.GsGCWO.Enabled(True)
				F.Intrinsic.Control.CallSub(enablescreen)
				F.Intrinsic.Control.ExitSub
		F.Intrinsic.Control.EndSelect
	F.Intrinsic.Control.EndIf

Program.Sub.GsGCWO_RowCellClick.End

Program.Sub.GsGCWO_CellValueChanged.Start
	V.Local.sSQL.Declare(String)
	V.Local.sJS.Declare(String)
	V.Local.sJob.Declare(String)
	V.Local.sSuffix.Declare(String)
	V.Local.sParams.Declare(String)
	V.Local.sText.Declare(String)
	V.Local.iFor.Declare(Long)
	v.Local.lQty.Declare(long)
	v.Local.iUbound.Declare(Long)

	v.Local.sSufx.Declare(String)
	v.Local.sProject.Declare(String)
	v.Local.sParts.Declare(String)
	v.Local.sLoc.Declare(String)
	V.Local.sDescr.Declare(String)
	V.Local.sNotes.Declare(String)
	F.Intrinsic.Control.If(V.Args.COLUMN,=,"NOTES")
		Gui.F_WO.GsGCWO.GetCellValue("gvWOs",2,V.Args.RowIndex,V.Local.sJob)
		Gui.F_WO.GsGCWO.GetCellValue("gvWOs",3,V.Args.RowIndex,V.Local.sSuffix)
		F.Intrinsic.String.Replace(V.Args.Value,"'","''",V.Local.sText)
		F.Intrinsic.String.Build("{0}{1}",V.Local.sJob,V.Local.sSuffix,V.Local.sJS)
		F.Intrinsic.String.Build("SELECT * FROM GAB_4135_WO_NOTES WHERE JS = '{0}';",V.Local.sJS,V.Local.sSQL)
		F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
		F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
			F.Intrinsic.String.Build("INSERT INTO GAB_4135_WO_NOTES(JS,JOB,SUFFIX,NOTES) VALUES('{0}','{1}','{2}','{3}');",V.Local.sJS,V.Local.sJob,V.Local.sSuffix,V.Local.sText,V.Local.sSQL)
			F.ODBC.Connection!con.Execute(V.Local.sSQL)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("DELETE FROM GAB_4135_WO_NOTES WHERE JS = '{0}';",V.Local.sJS,V.Local.sSQL)
			F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.String.Build("INSERT INTO GAB_4135_WO_NOTES(JS,JOB,SUFFIX,NOTES) VALUES('{0}','{1}','{2}','{3}');",V.Local.sJS,V.Local.sJob,V.Local.sSuffix,V.Local.sText,V.Local.sSQL)
			F.ODBC.Connection!con.Execute(V.Local.sSQL)
		F.Intrinsic.Control.EndIf
		F.ODBC.con!rstNotes.Close
	F.Intrinsic.Control.ElseIf(V.Args.COLUMN, =, "DashNotes")
		V.Local.iFor.Set(V.Args.RowIndex)
		v.Local.sJob.Set(V.datatable.dtWOs(v.Local.iFor).Job.fieldval)
		v.Local.sSufx.Set(V.datatable.dtWOs(v.Local.iFor).Suffix.fieldval)
		v.Local.sProject.Set(V.datatable.dtWOs(v.Local.iFor).Project.fieldval)
		v.Local.sParts.Set(V.datatable.dtWOs(v.Local.iFor).Part.fieldval)
		v.Local.sLoc.Set(V.datatable.dtWOs(v.Local.iFor).LOCATION.fieldval)
		V.Local.sDescr.Set(V.datatable.dtWOs(v.Local.iFor).DESCRIPTION.fieldval)
		V.Local.sNotes.Set(V.DataTable.dtWOs(V.Local.iFor).DashNotes.FieldVal)
		f.Intrinsic.String.Build("select * from GCG_4253_ShipDash where job='{0}' and suffix='{1}' and part='{2}' and loc='{3}' and project = '{4}'",v.Local.sJob,v.Local.sSufx,v.Local.sParts,v.Local.sLoc,v.Local.sProject,v.Local.sSQL)
			F.ODBC.Connection!con.openlocalrecordsetrw("rst",V.Local.sSQL)
		F.Intrinsic.Control.If(V.ODBC.con!rst.EOF,=,True)
			f.ODBC.con!rst.AddNew
			F.ODBC.con!rst.Set!Job(v.Local.sJob)
			F.ODBC.con!rst.Set!Suffix(v.Local.sSufx)
			F.ODBC.con!rst.Set!Project(v.Local.sProject)
			F.ODBC.con!rst.Set!Phase(V.datatable.dtWOs(v.Local.iFor).Phase.fieldval)
			v.Local.lQty.Set(V.datatable.dtWOs(v.Local.iFor).Qty_To_Ship.fieldval)
			F.ODBC.con!rst.Set!Qty_Shipped(v.Local.lQty)
			F.ODBC.con!rst.Set!Part(v.Local.sParts)
			F.ODBC.con!rst.Set!Loc(v.Local.sLoc)
			F.ODBC.con!rst.Set!Notes(V.Local.sNotes.Trim)
		f.Intrinsic.Control.Endif
		f.Intrinsic.Math.Add(V.datatable.dtWOs(v.Local.iFor).Qty_Shipped.fieldval,V.datatable.dtWOs(v.Local.iFor).Qty_To_Ship.fieldval,v.Local.lQty)
		F.ODBC.con!rst.Set!Qty_Shipped(v.Local.lQty)
		F.ODBC.con!rst.Set!Notes(V.Local.sNotes.Trim)
		f.ODBC.con!rst.Update
		f.ODBC.con!rst.Close 
	F.Intrinsic.Control.ElseIf(v.Args.Column, =, "DATE_DUE")
		'get Ordinal so we can reschedule later.  The dataview is not updating when the date changed for Modified Current or Modified Orginal
		F.Intrinsic.Control.If(v.Global.sOrdinal(0).trim, !=, "")
			F.Intrinsic.Math.Add(v.Global.sOrdinal.UBound, 1, v.Local.iUbound)
		F.Intrinsic.Control.Else
			v.Local.iUbound.Set(0)
		F.Intrinsic.Control.EndIf
		v.Global.sOrdinal.Redim(0,v.Local.iUbound)
		v.Global.sOrdinal(v.Local.iUbound).set(v.Args.RowIndex)	
		'Might need to add code to save the notes
	F.Intrinsic.Control.EndIf
Program.Sub.GsGCWO_CellValueChanged.End

Program.Sub.GsGCWO_ColumnFilterChanged.Start
	V.Local.bFilter.Declare(boolean)
	V.Local.sFilter.Declare(String)
	V.Local.sInvalid.Declare(String)
	V.Local.bRet.Declare(boolean)
	V.Local.iCnt.Declare(Long)
	V.Local.iCounter.Declare(Long,0)
	V.Local.sMsg.Declare(String)

	
	F.Intrinsic.String.Split("StartsWith*!*Between*!*Contains*!*EndsWith*!*IsNullOrEmpty*!*?*!*IsOutlookInterval","*!*",V.Local.sInvalid)
	F.Intrinsic.String.IsNullOrWhiteSpace(V.Args.ActiveFilterExpression,V.Local.bFilter)
	Function.Intrinsic.Control.If(V.Local.bFilter,=,True)
		v.Global.sFilter.Set("")
		F.Intrinsic.Control.CallSub(loadtotals,"Filter","JOB LIKE '%%' AND IND_FLAG <> True")
	Function.Intrinsic.Control.Else
		v.Global.sFilter.Set(V.Args.ActiveFilterExpression)
		F.Intrinsic.String.Replace(V.Args.ActiveFilterExpression,"[","",V.Local.sFilter)
		F.Intrinsic.String.Replace(V.Local.sFilter,"]","",V.Local.sFilter)

		
		
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sInvalid.UBound,1)
			F.Intrinsic.String.IsInString(V.Local.sFilter,V.Local.sInvalid(V.Local.iCnt),False,V.Local.bRet)
			F.Intrinsic.Control.If(V.Local.bRet,=,True)
				F.Intrinsic.Math.Add(V.Local.iCounter,1,V.Local.iCounter)
			F.Intrinsic.Control.endif
		F.Intrinsic.Control.Next(V.Local.iCnt)

		F.Intrinsic.Control.If(V.Local.iCounter,=,1)
			Function.Intrinsic.String.Build("Grid will be filtered, but totals will not be recalculated, because one of the filters entered is an invalid filter for recalculating totals.{0}{0}Invalid Filters for recalculating totals:{0}- Is between{0}- Is not between{0}- Contains{0}- Does not contain{0}- Beings with{0}- Ends with{0}- Is blank{0}- Is not blank{0}- ?{0}- Calendar Checkboxes",V.Ambient.NewLine,V.Local.sMsg)
			Function.Intrinsic.UI.Msgbox(V.Local.sMsg,"Filter Validation")
		F.Intrinsic.Control.ElseIf(V.Local.iCounter,>,1)
			Function.Intrinsic.String.Build("Grid will be filtered, but totals will not be recalculated, because more than one filter entered is an invalid filter for recalculating totals.{0}{0}Invalid Filters for recalculating totals:{0}- Is between{0}- Is not between{0}- Contains{0}- Does not contain{0}- Beings with{0}- Ends with{0}- Is blank{0}- Is not blank{0}- ?{0}- Calendar Checkboxes",V.Ambient.NewLine,V.Local.sMsg)
			Function.Intrinsic.UI.Msgbox(V.Local.sMsg,"Filter Validation")
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.CallSub(loadtotals,"Filter",V.Local.sFilter)
		F.Intrinsic.Control.EndIf
	Function.Intrinsic.Control.EndIf
Program.Sub.GsGCWO_ColumnFilterChanged.End

Program.Sub.SetAnchors.Start
	'0 - None
	'1 - Top
	'2 - Bottom
	'4 - Left
	'8 - Right
	
	Gui.F_WO.picGSSLogo.Anchor(1)
	Gui.F_WO.GsGCWO.Anchor(15)
	Gui.F_WO.frameOpt.Anchor(5)
	Gui.F_WO.frameFilters.Anchor(6)
	Gui.F_WO.frameTot.Anchor(10)
	Gui.F_WO.frameButtons.Anchor(9)
	Gui.F_WO.framePermissions.Anchor(9)
	Gui.F_WO.progressBarStatus.Anchor(5)
	Gui.F_WO.lblStatus.Anchor(5)
	gui.F_WO.cmdSchedule.Anchor(9)
Program.Sub.SetAnchors.End

Program.Sub.F_WO_Resize.Start
	V.Local.iX.Declare(long)
	
	F.Intrinsic.Math.Div(V.Screen.F_WO.Width,2,V.Local.iX)
	F.Intrinsic.Math.Sub(V.Local.iX,2000,V.Local.iX)
	Gui.F_WO.picGSSLogo.Position(V.Local.iX,45)

	'Let Form grow larger than 15375, but not lower
	F.Intrinsic.Control.If(V.Screen.F_WO.Width,<,15375)
		Gui.F_WO..Size(15375,V.Screen.F_WO.Height)
	F.Intrinsic.Control.EndIf
Program.Sub.F_WO_Resize.End

Program.Sub.cmdRefresh_Click.Start
	Gui.F_WO.chkCust.Value(0)
	Gui.F_WO.chkLoc.Value(0)
	Gui.F_WO.chkPL.Value(0)
	Gui.F_WO.chkWC.Value(0)
	Gui.F_WO.txtCust.Text("")
	Gui.F_WO.txtLoc.Text("")
	Gui.F_WO.txtPL.Text("")
	Gui.F_WO.txtWC.Text("")
	Gui.F_WO.cmdRefresh.Enabled(False)
	Gui.F_WO.GsGCWO.Visible(False)
	F.Intrinsic.Control.CallSub(serialize)
	F.Intrinsic.Control.CallSub(lockscreen)
	F.Intrinsic.Control.CallSub(checktable)
	F.Intrinsic.Control.CallSub(loaddtdvwos)
	F.Intrinsic.Control.CallSub(loadgvwos)
	F.Intrinsic.Control.CallSub(loaddtdvgvmatl)
	F.Intrinsic.Control.CallSub(loaddtdvgvlbr)
	F.Intrinsic.Control.CallSub(loaddtdvgvout)
'	F.Intrinsic.Control.CallSub(loadtotals,"Filter","JOB LIKE '%%'")
	'Remove indirect Jobs
	F.Intrinsic.Control.CallSub(loadtotals,"Filter","JOB LIKE '%%' AND IND_FLAG <> True")
	
	f.Intrinsic.Control.CallSub(update_status)
	F.Intrinsic.Control.CallSub(Formatting)
	F.Intrinsic.Control.CallSub(enablescreen)
	F.Intrinsic.Control.CallSub(Deserialize)
	Gui.F_WO.cmdRefresh.Enabled(True)
Program.Sub.cmdRefresh_Click.End

Program.Sub.cmdCust_Click.Start
	V.Local.sTitles.Declare(String)
	V.Local.iWidths.Declare(Long)
	V.Local.sRet.Declare(String)
	V.Local.iFilter.Declare(Long,0)
	V.Local.sSQL.Declare(String)
	
	F.Intrinsic.Control.If(V.Screen.F_WO!chkLoc.Value,=,1)
		F.Intrinsic.Math.Add(V.Local.iFilter,2,V.Local.iFilter)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Screen.F_WO!chkProj.Value,=,1)
		F.Intrinsic.Math.Add(V.Local.iFilter,4,V.Local.iFilter)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Screen.F_WO!chkPhase.Value,=,1)
		F.Intrinsic.Math.Add(V.Local.iFilter,8,V.Local.iFilter)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.String.Split("Customer*!*Name","*!*",V.Local.sTitles)
	F.Intrinsic.String.Split("1300*!*2300","*!*",V.Local.iWidths)
	
	F.Intrinsic.Control.SelectCase(V.Local.iFilter)
		F.Intrinsic.Control.Case(0)
			'No Filter Show All Customers
			F.Intrinsic.UI.MiniBrowser("Select Customer","con","SELECT DISTINCT A.CUSTOMER,B.NAME_CUSTOMER FROM V_JOB_HEADER A LEFT JOIN V_CUSTOMER_MASTER B ON A.CUSTOMER = B.CUSTOMER WHERE DATE_CLOSED = '1900-1-1' ORDER BY CUSTOMER;",V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(2)
			'LOCATION
			F.Intrinsic.String.Build("SELECT DISTINCT A.CUSTOMER,B.NAME_CUSTOMER FROM V_JOB_HEADER A LEFT JOIN V_CUSTOMER_MASTER B ON A.CUSTOMER = B.CUSTOMER WHERE DATE_CLOSED = '1900-1-1' AND LOCATION = '{0}' ORDER BY CUSTOMER;",V.Screen.F_WO!txtLoc.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Customer","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(4)
			'PROJECT
			F.Intrinsic.String.Build("SELECT DISTINCT A.CUSTOMER,B.NAME_CUSTOMER FROM V_JOB_HEADER A LEFT JOIN V_CUSTOMER_MASTER B ON A.CUSTOMER = B.CUSTOMER WHERE DATE_CLOSED = '1900-1-1' AND PROJECT = '{0}' ORDER BY CUSTOMER;",V.Screen.F_WO!txtProj.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Customer","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(6)
			'LOCATION & PROJECT
			F.Intrinsic.String.Build("SELECT DISTINCT A.CUSTOMER,B.NAME_CUSTOMER FROM V_JOB_HEADER A LEFT JOIN V_CUSTOMER_MASTER B ON A.CUSTOMER = B.CUSTOMER WHERE DATE_CLOSED = '1900-1-1' AND LOCATION = '{0}' AND PROJECT = '{1}' ORDER BY CUSTOMER;",V.Screen.F_WO!txtLoc.Text,V.Screen.F_WO!txtProj.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Customer","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(8)
			'PHASE
			F.Intrinsic.String.Build("SELECT DISTINCT A.CUSTOMER,B.NAME_CUSTOMER FROM V_JOB_HEADER A LEFT JOIN V_CUSTOMER_MASTER B ON A.CUSTOMER = B.CUSTOMER WHERE DATE_CLOSED = '1900-1-1' AND PHASE = '{0}' ORDER BY CUSTOMER;",V.Screen.F_WO!txtPhase.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Customer","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(10)
			'LOCATION & PHASE
			F.Intrinsic.String.Build("SELECT DISTINCT A.CUSTOMER,B.NAME_CUSTOMER FROM V_JOB_HEADER A LEFT JOIN V_CUSTOMER_MASTER B ON A.CUSTOMER = B.CUSTOMER WHERE DATE_CLOSED = '1900-1-1' AND LOCATION = '{0}' AND PHASE = '{1}' ORDER BY CUSTOMER;",V.Screen.F_WO!txtLoc.Text,V.Screen.F_WO!txtPhase.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Customer","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(12)
			'PROJECT & PHASE
			F.Intrinsic.String.Build("SELECT DISTINCT A.CUSTOMER,B.NAME_CUSTOMER FROM V_JOB_HEADER A LEFT JOIN V_CUSTOMER_MASTER B ON A.CUSTOMER = B.CUSTOMER WHERE DATE_CLOSED = '1900-1-1' AND PROJECT = '{0}' AND PHASE = '{1}' ORDER BY CUSTOMER;",V.Screen.F_WO!txtProj.Text,V.Screen.F_WO!txtPhase.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Customer","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(14)
			'LOCATION, PROJECT & PHASE
			F.Intrinsic.String.Build("SELECT DISTINCT A.CUSTOMER,B.NAME_CUSTOMER FROM V_JOB_HEADER A LEFT JOIN V_CUSTOMER_MASTER B ON A.CUSTOMER = B.CUSTOMER WHERE DATE_CLOSED = '1900-1-1' AND LOCATION = '{0}' AND PROJECT = '{1}' AND PHASE = '{2}' ORDER BY CUSTOMER;",V.Screen.F_WO!txtLoc.Text,V.Screen.F_WO!txtProj.Text,V.Screen.F_WO!txtPhase.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Customer","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
	F.Intrinsic.Control.EndSelect

	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		V.Global.sCustomer.Set(V.Local.sRet(0))
		Gui.F_WO.txtCust.Text(V.Local.sRet(1))
		Gui.F_WO.chkCust.Value(1)
	F.Intrinsic.Control.EndIf
Program.Sub.cmdCust_Click.End

Program.Sub.cmdLoc_Click.Start
	V.Local.sTitles.Declare(String)
	V.Local.iWidths.Declare(Long)
	V.Local.sRet.Declare(String)
	V.Local.iFilter.Declare(Long,0)
	V.Local.sSQL.Declare(String)
	
	F.Intrinsic.Control.If(V.Screen.F_WO!chkCust.Value,=,1)
		F.Intrinsic.Math.Add(V.Local.iFilter,1,V.Local.iFilter)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Screen.F_WO!chkProj.Value,=,1)
		F.Intrinsic.Math.Add(V.Local.iFilter,4,V.Local.iFilter)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Screen.F_WO!chkPhase.Value,=,1)
		F.Intrinsic.Math.Add(V.Local.iFilter,8,V.Local.iFilter)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.String.Split("Location*!*Description","*!*",V.Local.sTitles)
	F.Intrinsic.String.Split("1300*!*2300","*!*",V.Local.iWidths)
	
	F.Intrinsic.Control.SelectCase(V.Local.iFilter)
		F.Intrinsic.Control.Case(0)
			'No Filter Show All Locations
			F.Intrinsic.UI.MiniBrowser("Select Location","con","SELECT DISTINCT A.LOCATION,B.LOCATION_DESC FROM V_JOB_HEADER A LEFT JOIN V_LOCATIONS B ON A.LOCATION = B.LOCATION WHERE DATE_CLOSED = '1900-1-1' ORDER BY LOCATION;",V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(1)
			'CUSTOMER
			F.Intrinsic.String.Build("SELECT DISTINCT A.LOCATION,B.LOCATION_DESC FROM V_JOB_HEADER A LEFT JOIN V_LOCATIONS B ON A.LOCATION = B.LOCATION WHERE DATE_CLOSED = '1900-1-1' AND CUSTOMER = '{0}' ORDER BY LOCATION;",V.Global.sCustomer,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Location","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(4)
			'PROJECT
			F.Intrinsic.String.Build("SELECT DISTINCT A.LOCATION,B.LOCATION_DESC FROM V_JOB_HEADER A LEFT JOIN V_LOCATIONS B ON A.LOCATION = B.LOCATION WHERE DATE_CLOSED = '1900-1-1' AND PROJECT = '{0}' ORDER BY LOCATION;",V.Screen.F_WO!txtProj.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Location","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(5)
			'CUSTOMER & PROJECT
			F.Intrinsic.String.Build("SELECT DISTINCT A.LOCATION,B.LOCATION_DESC FROM V_JOB_HEADER A LEFT JOIN V_LOCATIONS B ON A.LOCATION = B.LOCATION WHERE DATE_CLOSED = '1900-1-1' AND CUSTOMER = '{0}' AND PROJECT = '{1}' ORDER BY LOCATION;",V.Global.sCustomer,V.Screen.F_WO!txtProj.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Location","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(8)
			'PHASE
			F.Intrinsic.String.Build("SELECT DISTINCT A.LOCATION,B.LOCATION_DESC FROM V_JOB_HEADER A LEFT JOIN V_LOCATIONS B ON A.LOCATION = B.LOCATION WHERE DATE_CLOSED = '1900-1-1' AND PHASE = '{0}' ORDER BY LOCATION;",V.Screen.F_WO!txtPhase.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Location","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(9)
			'CUSTOMER & PHASE
			F.Intrinsic.String.Build("SELECT DISTINCT A.LOCATION,B.LOCATION_DESC FROM V_JOB_HEADER A LEFT JOIN V_LOCATIONS B ON A.LOCATION = B.LOCATION WHERE DATE_CLOSED = '1900-1-1' AND CUSTOMER = '{0}' AND PHASE = '{1}' ORDER BY LOCATION;",V.Global.sCustomer,V.Screen.F_WO!txtPhase.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Location","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(12)
			'PROJECT & PHASE
			F.Intrinsic.String.Build("SELECT DISTINCT A.LOCATION,B.LOCATION_DESC FROM V_JOB_HEADER A LEFT JOIN V_LOCATIONS B ON A.LOCATION = B.LOCATION WHERE DATE_CLOSED = '1900-1-1' AND PROJECT = '{0}' AND PHASE = '{1}' ORDER BY LOCATION;",V.Screen.F_WO!txtProj.Text,V.Screen.F_WO!txtPhase.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Location","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(13)
			'CUSTOMER, PROJECT & PHASE
			F.Intrinsic.String.Build("SELECT DISTINCT A.LOCATION,B.LOCATION_DESC FROM V_JOB_HEADER A LEFT JOIN V_LOCATIONS B ON A.LOCATION = B.LOCATION WHERE DATE_CLOSED = '1900-1-1' AND CUSTOMER = '{0}' AND PROJECT = '{1}' AND PHASE = '{2}' ORDER BY LOCATION;",V.Global.sCustomer,V.Screen.F_WO!txtProj.Text,V.Screen.F_WO!txtPhase.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Location","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		Gui.F_WO.txtLoc.Text(V.Local.sRet(0))
		Gui.F_WO.chkLoc.Value(1)
	F.Intrinsic.Control.EndIf
Program.Sub.cmdLoc_Click.End

Program.Sub.cmdProject_Click.Start
	V.Local.sTitles.Declare(String)
	V.Local.iWidths.Declare(Long)
	V.Local.sRet.Declare(String)
	V.Local.iFilter.Declare(Long,0)
	V.Local.sSQL.Declare(String)
	
	F.Intrinsic.Control.If(V.Screen.F_WO!chkCust.Value,=,1)
		F.Intrinsic.Math.Add(V.Local.iFilter,1,V.Local.iFilter)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Screen.F_WO!chkLoc.Value,=,1)
		F.Intrinsic.Math.Add(V.Local.iFilter,2,V.Local.iFilter)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Screen.F_WO!chkPhase.Value,=,1)
		F.Intrinsic.Math.Add(V.Local.iFilter,8,V.Local.iFilter)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.String.Split("Project*!*Description","*!*",V.Local.sTitles)
	F.Intrinsic.String.Split("1300*!*2300","*!*",V.Local.iWidths)

	F.Intrinsic.Control.SelectCase(V.Local.iFilter)
		F.Intrinsic.Control.Case(0)
			'No Filter Show All Projects
			F.Intrinsic.UI.MiniBrowser("Select Project","con","SELECT DISTINCT PROJECT,B.DESCR FROM V_JOB_HEADER A LEFT JOIN PROJECT_MASTER B ON A.PROJECT = B.PROJECT WHERE DATE_CLOSED = '1900-1-1' ORDER BY PROJECT;",V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(1)
			'CUSTOMER
			F.Intrinsic.String.Build("SELECT DISTINCT PROJECT,B.DESCR FROM V_JOB_HEADER A LEFT JOIN PROJECT_MASTER B ON A.PROJECT = B.PROJECT WHERE DATE_CLOSED = '1900-1-1' AND CUSTOMER = '{0}' ORDER BY PROJECT;",V.Global.sCustomer,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Project","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(2)
			'LOCATION
			F.Intrinsic.String.Build("SELECT DISTINCT PROJECT,B.DESCR FROM V_JOB_HEADER A LEFT JOIN PROJECT_MASTER B ON A.PROJECT = B.PROJECT WHERE DATE_CLOSED = '1900-1-1' AND LOCATION = '{1}' ORDER BY PROJECT;",V.Screen.F_WO!txtLoc.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Project","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(3)
			'CUSTOMER & LOCATION
			F.Intrinsic.String.Build("SELECT DISTINCT PROJECT,B.DESCR FROM V_JOB_HEADER A LEFT JOIN PROJECT_MASTER B ON A.PROJECT = B.PROJECT WHERE DATE_CLOSED = '1900-1-1' AND CUSTOMER = '{0}' AND LOCATION = '{1}' ORDER BY PROJECT;",V.Global.sCustomer,V.Screen.F_WO!txtLoc.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Project","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(8)
			'PHASE
			F.Intrinsic.String.Build("SELECT DISTINCT PROJECT,B.DESCR FROM V_JOB_HEADER A LEFT JOIN PROJECT_MASTER B ON A.PROJECT = B.PROJECT WHERE DATE_CLOSED = '1900-1-1' AND PHASE = '{0}' ORDER BY PROJECT;",V.Screen.F_WO!txtPhase.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Project","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(9)
			'CUSTOMER & PHASE
			F.Intrinsic.String.Build("SELECT DISTINCT PROJECT,B.DESCR FROM V_JOB_HEADER A LEFT JOIN PROJECT_MASTER B ON A.PROJECT = B.PROJECT WHERE DATE_CLOSED = '1900-1-1' AND CUSTOMER = '{0}' AND PHASE = '{1}' ORDER BY PROJECT;",V.Global.sCustomer,V.Screen.F_WO!txtPhase.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Project","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(10)
			'LOCATION & PHASE
			F.Intrinsic.String.Build("SELECT DISTINCT PROJECT,B.DESCR FROM V_JOB_HEADER A LEFT JOIN PROJECT_MASTER B ON A.PROJECT = B.PROJECT WHERE DATE_CLOSED = '1900-1-1' AND LOCATION = '{0}' AND PHASE = '{1}' ORDER BY PROJECT;",V.Screen.F_WO!txtLoc.Text,V.Screen.F_WO!txtPhase.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Project","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(11)
			'CUSTOMER, LOCATION & PHASE
			F.Intrinsic.String.Build("SELECT DISTINCT PROJECT,B.DESCR FROM V_JOB_HEADER A LEFT JOIN PROJECT_MASTER B ON A.PROJECT = B.PROJECT WHERE DATE_CLOSED = '1900-1-1' AND CUSTOMER = '{0}' AND LOCATION = '{1}' AND PHASE '{2}' ORDER BY PROJECT;",V.Global.sCustomer,v.Screen.F_WO!txtLoc.Text,V.Screen.F_WO!txtPhase.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Project","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		Gui.F_WO.txtProj.Text(V.Local.sRet(0))
		Gui.F_WO.chkProj.Value(1)
	F.Intrinsic.Control.EndIf
Program.Sub.cmdProject_Click.End

Program.Sub.cmdPhase_Click.Start
	V.Local.sTitles.Declare(String)
	V.Local.iWidths.Declare(Long)
	V.Local.sRet.Declare(String)
	V.Local.iFilter.Declare(Long,0)
	V.Local.sSQL.Declare(String)
	
	F.Intrinsic.Control.If(V.Screen.F_WO!chkCust.Value,=,1)
		F.Intrinsic.Math.Add(V.Local.iFilter,1,V.Local.iFilter)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Screen.F_WO!chkLoc.Value,=,1)
		F.Intrinsic.Math.Add(V.Local.iFilter,2,V.Local.iFilter)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Screen.F_WO!chkProj.Value,=,1)
		F.Intrinsic.Math.Add(V.Local.iFilter,4,V.Local.iFilter)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.String.Split("Phase*!*Description","*!*",V.Local.sTitles)
	F.Intrinsic.String.Split("1300*!*2300","*!*",V.Local.iWidths)
	
	F.Intrinsic.Control.SelectCase(V.Local.iFilter)
		F.Intrinsic.Control.Case(0)
			'No Filter Show All Phases
			F.Intrinsic.UI.MiniBrowser("Select Phase","con","SELECT DISTINCT PHASE,B.DESCR FROM V_JOB_HEADER A LEFT JOIN PROJECT_PHASE B ON A.PHASE = B.PHASE WHERE DATE_CLOSED = '1900-1-1' ORDER BY PHASE;",V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(1)
			'CUSTOMER
			F.Intrinsic.String.Build("SELECT DISTINCT PHASE,B.DESCR FROM V_JOB_HEADER A LEFT JOIN PROJECT_PHASE B ON A.PHASE = B.PHASE WHERE DATE_CLOSED = '1900-1-1' AND CUSTOMER = '{0}' ORDER BY PHASE;",V.Global.sCustomer,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Phase","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(2)
			'LOCATION
			F.Intrinsic.String.Build("SELECT DISTINCT PHASE,B.DESCR FROM V_JOB_HEADER A LEFT JOIN PROJECT_PHASE B ON A.PHASE = B.PHASE WHERE DATE_CLOSED = '1900-1-1' AND LOCATION = '{0}' ORDER BY PHASE;",V.Screen.F_WO!txtLoc.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Phase","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(3)
			'CUSTOMER & LOCATION
			F.Intrinsic.String.Build("SELECT DISTINCT PHASE,B.DESCR FROM V_JOB_HEADER A LEFT JOIN PROJECT_PHASE B ON A.PHASE = B.PHASE WHERE DATE_CLOSED = '1900-1-1' AND CUSTOMER = '{0}' AND LOCATION = '{1}' ORDER BY PHASE;",V.Global.sCustomer,V.Screen.F_WO!txtLoc.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Phase","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(4)
			'PROJECT
			F.Intrinsic.String.Build("SELECT DISTINCT PHASE,B.DESCR FROM V_JOB_HEADER A LEFT JOIN PROJECT_PHASE B ON A.PHASE = B.PHASE WHERE DATE_CLOSED = '1900-1-1' AND PROJECT = '{0}' ORDER BY PHASE;",V.Screen.F_WO!txtProj.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Phase","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(5)
			'CUSTOMER & PROJECT
			F.Intrinsic.String.Build("SELECT DISTINCT PHASE,B.DESCR FROM V_JOB_HEADER A LEFT JOIN PROJECT_PHASE B ON A.PHASE = B.PHASE WHERE DATE_CLOSED = '1900-1-1' AND CUSTOMER = '{0}' AND PROJECT = '{1}' ORDER BY PHASE;",V.Global.sCustomer,V.Screen.F_WO!txtProj.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Phase","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(6)
			'LOCATION & PROJECT
			F.Intrinsic.String.Build("SELECT DISTINCT PHASE,B.DESCR FROM V_JOB_HEADER A LEFT JOIN PROJECT_PHASE B ON A.PHASE = B.PHASE WHERE DATE_CLOSED = '1900-1-1' AND LOCATION = '{0}' AND PROJECT = '{1}' ORDER BY PHASE;",V.Screen.F_WO!txtLoc.Text,V.Screen.F_WO!txtProj.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Phase","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
		F.Intrinsic.Control.Case(7)
			'CUSTOMER, LOCATION & PROJECT
			F.Intrinsic.String.Build("SELECT DISTINCT PHASE,B.DESCR FROM V_JOB_HEADER A LEFT JOIN PROJECT_PHASE B ON A.PHASE = B.PHASE WHERE DATE_CLOSED = '1900-1-1' AND CUSTOMER = '{0}' AND LOCATION = '{1}' AND PROJECT = '{2}' ORDER BY PHASE;",V.Global.sCustomer,V.Screen.F_WO!txtLoc.Text,V.Screen.F_WO!txtProj.Text,V.Local.sSQL)
			F.Intrinsic.UI.MiniBrowser("Select Phase","con",V.Local.sSQL,V.Local.sTitles,V.Local.iWidths,V.Local.sRet)
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		Gui.F_WO.txtPhase.Text(V.Local.sRet(0))
		Gui.F_WO.chkPhase.Value(1)
	F.Intrinsic.Control.EndIf
Program.Sub.cmdPhase_Click.End

Program.Sub.cmdFilter_Click.Start
	V.Local.iFilter.Declare(Long,0)
	V.Local.sFilter.Declare(String)
	
	Gui.F_WO.lblStatus.Visible(True)
	Gui.F_WO.lblStatus.Caption("Setting Filter(s)....")
	Gui.F_WO.progressBarStatus.Visible(True)
	Gui.F_WO.progressBarStatus.Min(0)
	Gui.F_WO.progressBarStatus.Max(100)
	Gui.F_WO.progressBarStatus.Value(20)

	F.Intrinsic.Control.If(V.DataView.dtWOs!dvWOs.Exists)
		F.Data.DataView.Close("dtWOs","dvWOs")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Screen.F_WO!chkCust.Value,=,1)
		F.Intrinsic.Math.Add(V.Local.iFilter,1,V.Local.iFilter)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Screen.F_WO!chkLoc.Value,=,1)
		F.Intrinsic.Math.Add(V.Local.iFilter,2,V.Local.iFilter)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Screen.F_WO!chkProj.Value,=,1)
		F.Intrinsic.Math.Add(V.Local.iFilter,4,V.Local.iFilter)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Screen.F_WO!chkPhase.Value,=,1)
		F.Intrinsic.Math.Add(V.Local.iFilter,8,V.Local.iFilter)
	F.Intrinsic.Control.EndIf

	Gui.F_WO.progressBarStatus.Value(40)
	F.Intrinsic.Control.If(V.Local.iFilter,<>,0)
		F.Intrinsic.Control.CallSub(lockscreen)
		F.Intrinsic.Control.SelectCase(V.Local.iFilter)
			F.Intrinsic.Control.Case(1)
				'NAME_CUSTOMER
				F.Intrinsic.String.Build("NAME_CUSTOMER = '{0}' AND IND_FLAG <> True",V.Screen.F_WO!txtCust.Text,V.Local.sFilter)
				F.Data.DataView.Create("dtWOs","dvWOs",22,V.Local.sFilter,"DATE_DUE ASC,JOB ASC,SUFFIX ASC")
			F.Intrinsic.Control.Case(2)
				'LOCATION
				F.Intrinsic.String.Build("LOCATION = '{0}' AND IND_FLAG <> True",V.Screen.F_WO!txtLoc.Text,V.Local.sFilter)
				F.Data.DataView.Create("dtWOs","dvWOs",22,V.Local.sFilter,"DATE_DUE ASC,JOB ASC,SUFFIX ASC")
			F.Intrinsic.Control.Case(3)
				'NAME_CUSTOMER & LOCATION
				F.Intrinsic.String.Build("NAME_CUSTOMER = '{0}' AND LOCATION = '{1}' AND IND_FLAG <> True",V.Screen.F_WO!txtCust.Text,V.Screen.F_WO!txtLoc.Text,V.Local.sFilter)
				F.Data.DataView.Create("dtWOs","dvWOs",22,V.Local.sFilter,"DATE_DUE ASC,JOB ASC,SUFFIX ASC")
			F.Intrinsic.Control.Case(4)
				'PROJECT
				F.Intrinsic.String.Build("PROJECT = '{0}' AND IND_FLAG <> True",V.Screen.F_WO!txtProj.Text,V.Local.sFilter)
				F.Data.DataView.Create("dtWOs","dvWOs",22,V.Local.sFilter,"DATE_DUE ASC,JOB ASC,SUFFIX ASC")
			F.Intrinsic.Control.Case(5)
				'NAME_CUSTOMER & PROJECT
				F.Intrinsic.String.Build("NAME_CUSTOMER = '{0}' AND PROJECT = '{1}' AND IND_FLAG <> True",V.Screen.F_WO!txtCust.Text,V.Screen.F_WO!txtProj.Text,V.Local.sFilter)
				F.Data.DataView.Create("dtWOs","dvWOs",22,V.Local.sFilter,"DATE_DUE ASC,JOB ASC,SUFFIX ASC")
			F.Intrinsic.Control.Case(6)
				'LOCATION & PROJECT
				F.Intrinsic.String.Build("LOCATION = '{0}' AND PROJECT = '{1}' AND IND_FLAG <> True",V.Screen.F_WO!txtLoc.Text,V.Screen.F_WO!txtProj.Text,V.Local.sFilter)
				F.Data.DataView.Create("dtWOs","dvWOs",22,V.Local.sFilter,"DATE_DUE ASC,JOB ASC,SUFFIX ASC")
			F.Intrinsic.Control.Case(7)
				'NAME_CUSTOMER, LOCATION & PROJECT
				F.Intrinsic.String.Build("NAME_CUSTOMER = '{0}' AND LOCATION = '{1}' AND PROJECT = '{2}' AND IND_FLAG <> True",V.Screen.F_WO!txtCust.Text,V.Screen.F_WO!txtLoc.Text,V.Screen.F_WO!txtProj.Text,V.Local.sFilter)
				F.Data.DataView.Create("dtWOs","dvWOs",22,V.Local.sFilter,"DATE_DUE ASC,JOB ASC,SUFFIX ASC")
			F.Intrinsic.Control.Case(8)
				'PHASE
				F.Intrinsic.String.Build("PHASE = '{0}' AND IND_FLAG <> True",V.Screen.F_WO!txtPhase.Text,V.Local.sFilter)
				F.Data.DataView.Create("dtWOs","dvWOs",22,V.Local.sFilter,"DATE_DUE ASC,JOB ASC,SUFFIX ASC")
			F.Intrinsic.Control.Case(9)
				'NAME_CUSTOMER & PHASE
				F.Intrinsic.String.Build("NAME_CUSTOMER = '{0}' AND PHASE = '{1}' AND IND_FLAG <> True",V.Screen.F_WO!txtCust.Text,V.Screen.F_WO!txtPhase.Text,V.Local.sFilter)
				F.Data.DataView.Create("dtWOs","dvWOs",22,V.Local.sFilter,"DATE_DUE ASC,JOB ASC,SUFFIX ASC")
			F.Intrinsic.Control.Case(10)
				'LOCATION & PHASE
				F.Intrinsic.String.Build("LOCATION = '{0}' AND PHASE = '{1}' AND IND_FLAG <> True",V.Screen.F_WO!txtLoc.Text,V.Screen.F_WO!txtPhase.Text,V.Local.sFilter)
				F.Data.DataView.Create("dtWOs","dvWOs",22,V.Local.sFilter,"DATE_DUE ASC,JOB ASC,SUFFIX ASC")
			F.Intrinsic.Control.Case(11)
				'NAME_CUSTOMER, LOCATION & PHASE
				F.Intrinsic.String.Build("NAME_CUSTOMER = '{0}' AND LOCATION = '{1}' AND PHASE = '{3}' AND IND_FLAG <> True",V.Screen.F_WO!txtCust.Text,V.Screen.F_WO!txtLoc.Text,V.Screen.F_WO!txtPhase.Text,V.Local.sFilter)
				F.Data.DataView.Create("dtWOs","dvWOs",22,V.Local.sFilter,"DATE_DUE ASC,JOB ASC,SUFFIX ASC")
			F.Intrinsic.Control.Case(12)
				'PROJECT & PHASE
				F.Intrinsic.String.Build("PROJECT = '{0}' AND PHASE = '{1}' AND IND_FLAG <> True",V.Screen.F_WO!txtProj.Text,V.Screen.F_WO!txtPhase.Text,V.Local.sFilter)
				F.Data.DataView.Create("dtWOs","dvWOs",22,V.Local.sFilter,"DATE_DUE ASC,JOB ASC,SUFFIX ASC")
			F.Intrinsic.Control.Case(13)
				'NAME_CUSTOMER, PROJECT & PHASE
				F.Intrinsic.String.Build("NAME_CUSTOMER = '{0}' AND PROJECT = '{2}' AND PHASE = '{3}' AND IND_FLAG <> True",V.Screen.F_WO!txtCust.Text,V.Screen.F_WO!txtProj.Text,V.Screen.F_WO!txtPhase.Text,V.Local.sFilter)
				F.Data.DataView.Create("dtWOs","dvWOs",22,V.Local.sFilter,"DATE_DUE ASC,JOB ASC,SUFFIX ASC")
			F.Intrinsic.Control.Case(14)
				'LOCATION, PROJECT & PHASE
				F.Intrinsic.String.Build("LOCATION = '{0}' AND PROJECT = '{1}' AND PHASE = '{2}' AND IND_FLAG <> True",V.Screen.F_WO!txtLoc.Text,V.Screen.F_WO!txtProj.Text,V.Screen.F_WO!txtPhase.Text,V.Local.sFilter)
				F.Data.DataView.Create("dtWOs","dvWOs",22,V.Local.sFilter,"DATE_DUE ASC,JOB ASC,SUFFIX ASC")
			F.Intrinsic.Control.Case(15)
				'NAME_CUSTOMER, LOCATION, PROJECT & PHASE
				F.Intrinsic.String.Build("NAME_CUSTOMER = '{0}' AND LOCATION = '{1}' AND PROJECT = '{2}' AND PHASE = '{3}' AND IND_FLAG <> True",V.Screen.F_WO!txtCust.Text,V.Screen.F_WO!txtLoc.Text,V.Screen.F_WO!txtProj.Text,V.Screen.F_WO!txtPhase.Text,V.Local.sFilter)
				F.Data.DataView.Create("dtWOs","dvWOs",22,V.Local.sFilter,"DATE_DUE ASC,JOB ASC,SUFFIX ASC")
		F.Intrinsic.Control.EndSelect
		Gui.F_WO.progressBarStatus.Value(60)
		F.Intrinsic.Control.CallSub(loadgvwos)
		Gui.F_WO.progressBarStatus.Value(80)
		F.Intrinsic.Control.CallSub(loadtotals,"Filter",V.Local.sFilter)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(cmdrefresh_click)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(enablescreen)
	Gui.F_WO.progressBarStatus.Value(100)
Program.Sub.cmdFilter_Click.End

Program.Sub.LockScreen.Start
	Gui.F_WO.GsGCWO.Visible(False)
	Gui.F_WO.frameButtons.Enabled(False)
	Gui.F_WO.framePermissions.Enabled(False)
	Gui.F_WO.frameFilters.Enabled(False)
	Gui.F_WO.frameTot.Enabled(False)
Program.Sub.LockScreen.End

Program.Sub.EnableScreen.Start
	Gui.F_WO.frameButtons.Enabled(True)
	Gui.F_WO.framePermissions.Enabled(True)
	Gui.F_WO.frameFilters.Enabled(True)
	Gui.F_WO.frameTot.Enabled(True)
	Gui.F_WO.GsGCWO.Visible(True)
	Gui.F_WO.lblStatus.Visible(False)
	Gui.F_WO.progressBarStatus.Visible(False)
Program.Sub.EnableScreen.End

Program.Sub.LoadTotals.Start
	V.Local.fEstHrs.Declare(Float)
	V.Local.sEstHrs.Declare(String)
	V.Local.fActHrs.Declare(Float)
	V.Local.sActHrs.Declare(String)
	V.Local.fRemHrs.Declare(Float)
	V.Local.sRemHrs.Declare(String)
	
	F.Data.DataTable.Compute("dtWOs","SUM(EST_HRS)",V.Args.Filter,V.Local.fEstHrs)
	F.Data.DataTable.Compute("dtWOs","SUM(ACT_HRS)",V.Args.Filter,V.Local.fActHrs)
	F.Data.DataTable.Compute("dtWOs","SUM(REM_HRS)",V.Args.Filter,V.Local.fRemHrs)
	
	F.Intrinsic.String.Format(V.Local.fEstHrs,"#,###,###,##0.00",V.Local.sEstHrs)
	Gui.F_WO.txtEstHrs.Text(V.Local.sEstHrs)
	F.Intrinsic.String.Format(V.Local.fActHrs,"#,###,###,##0.00",V.Local.sActHrs)
	Gui.F_WO.txtActHrs.Text(V.Local.sActHrs)
	F.Intrinsic.String.Format(V.Local.fRemHrs,"#,###,###,##0.00",V.Local.sRemHrs)
	Gui.F_WO.txtRemHrs.Text(V.Local.sRemHrs)
Program.Sub.LoadTotals.End

Program.Sub.LoadDTDVGVMatl.Start
	V.Local.iRet.Declare
	V.Local.iCnt.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtWOs$dtMatl.Exists, =, True)
		F.Data.DataTable.Close("dtWOs$dtMatl")
	F.Intrinsic.Control.EndIf
	
	F.Data.DataTable.CreateFromSQL("dtWOs$dtMatl","con","SELECT DISTINCT CONCAT(A.JOB,A.SUFFIX) AS JBSF,CONCAT(CONCAT(A.JOB,A.SUFFIX),A.SEQ) AS JSS,A.JOB AS JOB1,A.SUFFIX AS SFX1,A.SEQ AS SEQ1,A.PART AS PART1,C.LOCATION AS LOCATION1,A.DESCRIPTION AS DESCR,E.VENDOR,E.PURCHASE_ORDER,LEFT(E.RECORD_NO,3) AS LINE,IF(E.DATE_DUE_LINE = '1900-1-1',NULL,E.DATE_DUE_LINE) AS DATE_DUE_LINE,D.AMT_COST,B.PCSTOPROD,B.PCSCOMPL,B.PCSREMAIN,IF(D.QTY_ONHAND IS NULL,'0.0000',D.QTY_ONHAND) AS QTY_ONHAND,(SELECT Sum(QUANTITY) as qty FROM V_ITEM_MASTER WHERE PART = A.PART AND BIN = 'T00000' and rtrim(HEAT) = '') AS T_ON_HAND,(SELECT Sum(QUANTITY) as qty FROM V_ITEM_MASTER WHERE PART = A.PART AND BIN = 'S00000' AND rtrim(HEAT) = '') AS S_ON_HAND,IF(D.QTY_ONORDER_PO IS NULL,'0.0000',D.QTY_ONORDER_PO) AS QTY_ONORDER_PO,IF(D.QTY_ONORDER_WO IS NULL,'0.0000',D.QTY_ONORDER_WO) AS QTY_ONORDER_WO,IF(D.QTY_REQUIRED IS NULL,'0.0000',D.QTY_REQUIRED) AS QTY_REQUIRED FROM JOB_OPERATIONS A LEFT JOIN APSV3_JBLINES B ON JSS = B.JSS LEFT JOIN JOB_HEADER C ON A.JOB = C.JOB AND A.SUFFIX = C.SUFFIX LEFT JOIN INVENTORY_MSTR D ON A.PART = D.PART AND C.LOCATION = D.LOCATION LEFT JOIN V_PO_LINES E ON A.JOB = E.JOB AND A.SUFFIX = E.SUFFIX  AND A.SEQ = E.SEQUENCE WHERE A.LMO = 'M' AND A.SEQ NOT IN ('995000','998000') AND JBSF IN (SELECT CONCAT(JOB,SUFFIX) AS JBSFX FROM V_JOB_HEADER WHERE DATE_CLOSED = '1900-1-1') ORDER BY SEQ1;",True)
	F.Data.DataView.Create("dtWOs$dtMatl","dvMatl")
	F.Data.DataTable.AddRelation("dtWOs","JS","dtWOs$dtMatl","JBSF","Material")
	
	Gui.F_WO.GsGCWO.AddGridViewFromDataView("gvMatl","dtWOs","dvMatl")
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvMatl","MultiSelect",True)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvMatl","OptionBehaviorEditable",False)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvMatl","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvMatl","AllowSort",True)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvMatl","AllowFilter",True)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvMatl","OptionsDetailShowDetailTabs",False)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvMatl","OptionsViewShowGroupPanel",False)

	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","JBSF","Visible",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","JSS","Visible",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","JOB1","Visible",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","SFX1","Visible",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","QTY_ONHAND","Visible",False)
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","SEQ1","Caption","Seq ")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PART1","Caption","Part ")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","LOCATION1","Caption","Loc")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","DESCR","Caption","Description")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","VENDOR","Caption","Vendor ")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PURCHASE_ORDER","Caption","PO")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","LINE","Caption","PO Line")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","DATE_DUE_LINE","Caption","Due Date")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","AMT_COST","Caption","Unit Cost")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PCSTOPROD","Caption","Qty. Req'd")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PCSCOMPL","Caption","Qty. Issued")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PCSREMAIN","Caption","Qty. Rem.")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","QTY_ONHAND","Caption","On Hand")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","S_ON_HAND","Caption","SC On Hand")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","T_ON_HAND","Caption","TX On Hand")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","QTY_ONORDER_PO","Caption","On Order PO")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","QTY_ONORDER_WO","Caption","On Order WO")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","QTY_REQUIRED","Caption","Total Req'd")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","SEQ1","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PART1","MinWidth","150")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","LOCATION1","MinWidth","25")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","DESCR","MinWidth","200")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","VENDOR","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PURCHASE_ORDER","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","LINE","MinWidth","35")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","DATE_DUE_LINE","MinWidth","100")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","AMT_COST","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PCSTOPROD","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PCSCOMPL","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PCSREMAIN","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","QTY_ONHAND","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","S_ON_HAND","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","T_ON_HAND","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","QTY_ONORDER_PO","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","QTY_ONORDER_WO","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","QTY_REQUIRED","MinWidth","75")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","SEQ1","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","LOCATION1","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","VENDOR","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PURCHASE_ORDER","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","LINE","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","DATE_DUE_LINE","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","AMT_COST","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PCSTOPROD","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PCSCOMPL","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PCSREMAIN","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","QTY_ONHAND","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","S_ON_HAND","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","T_ON_HAND","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","QTY_ONORDER_PO","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","QTY_ONORDER_WO","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","QTY_REQUIRED","HeaderHAlignment","Center")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","SEQ1","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","LOCATION1","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","VENDOR","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PURCHASE_ORDER","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","LINE","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","DATE_DUE_LINE","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","AMT_COST","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PCSTOPROD","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PCSCOMPL","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PCSREMAIN","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","QTY_ONHAND","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","T_ON_HAND","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","S_ON_HAND","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","QTY_ONORDER_PO","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","QTY_ONORDER_WO","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","QTY_REQUIRED","CellHAlignment","Center")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","SEQ1","Fixed","Left")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PART1","CellFontUnderline",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","LOCATION1","CellFontUnderline",True)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PURCHASE_ORDER","CellFontUnderline",True)
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PART1","CellForeColor","Blue")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","LOCATION1","CellForeColor","Blue")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","PURCHASE_ORDER","CellForeColor","Blue")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","T_ON_HAND","DisplayCustomNumeric","########0.0000")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","S_ON_HAND","DisplayCustomNumeric","########0.0000")
	
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","AMT_COST","DisplayCustomNumeric","$#,###,###,##0.0000")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvMatl","DATE_DUE_LINE","DisplayCustomDatetime","d")
	
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtWOs$dtMatl.RowCount--,1)
		Function.Intrinsic.Math.Mod(V.Local.iCnt,2,V.Local.iRet)
		Function.Intrinsic.Control.If(V.Local.iRet,=,0)
			Gui.F_WO.GsGCWO.SetRowAppearance("gvMatl",V.Local.iCnt,"BackColor","AliceBlue")
		Function.Intrinsic.Control.EndIf		
		
	F.Intrinsic.Control.Next(V.Local.iCnt)
	Gui.F_WO.GsGCWO.ResumeLayout()

Program.Sub.LoadDTDVGVMatl.End

Program.Sub.LoadDTDVGVLbr.Start
	V.Local.iRet.Declare
	V.Local.iCnt.Declare
	F.Intrinsic.Control.If(v.DataTable.dtWOs$dtLbr.Exists, =, True)
		f.Data.DataTable.Close("dtWOs$dtLbr")
	F.Intrinsic.Control.EndIf

	F.Data.DataTable.CreateFromSQL("dtWOs$dtLbr","con","SELECT DISTINCT CONCAT(A.JOB,A.SUFFIX) AS JBSF,CONCAT(CONCAT(A.JOB,A.SUFFIX),A.SEQ) AS JSS,A.JOB,A.SUFFIX,A.SEQ,B.SEQRES,B.DESCR,B.STARTDATE,B.DUEDATE,B.COMPLDATE,A.CODE_SORT_OPER,B.OVERLAP,B.NOMACH,B.FLOAT,B.HOURSORIG AS EST_HRS,B.HOURSAPPL AS ACT_HRS,B.HOURSREM AS REM_HRS,B.PCSTOPROD AS ORDER_QTY,B.PCSCOMPL AS COMPL_QTY,B.PCSREMAIN AS PCS_REM FROM JOB_OPERATIONS A LEFT JOIN APSV3_JBLINES B ON JSS = B.JSS WHERE A.LMO = 'L' AND A.SEQ NOT IN ('996000','998500') AND JBSF IN (SELECT CONCAT(JOB,SUFFIX) AS JBSFX FROM V_JOB_HEADER WHERE DATE_CLOSED = '1900-1-1') ORDER BY A.JOB,A.SUFFIX,A.SEQ;",True)
	F.Data.DataView.Create("dtWOs$dtLbr","dvLbr")
	F.Data.DataTable.AddRelation("dtWOs","JS","dtWOs$dtLbr","JBSF","Labor")
	
	
	
	Gui.F_WO.GsGCWO.AddGridViewFromDataView("gvLbr","dtWOs","dvLbr")
	
	
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvLbr","MultiSelect",True)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvLbr","OptionBehaviorEditable",False)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvLbr","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvLbr","AllowSort",True)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvLbr","AllowFilter",True)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvLbr","OptionsDetailShowDetailTabs",False)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvLbr","OptionsViewShowGroupPanel",False)
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","JBSF","Visible",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","JSS","Visible",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","JOB","Visible",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","SUFFIX","Visible",False)
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","OVERLAP","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","NOMACH","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","FLOAT","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","EST_HRS","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","ACT_HRS","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","REM_HRS","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","ORDER_QTY","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","COMPL_QTY","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","PCS_REM","DisplayCustomNumeric","#,###,###,##0.00")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","SEQ","Caption","Seq ")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","SEQRES","Caption","WC")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","DESCR","Caption","Description")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","STARTDATE","Caption","Start Date")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","DUEDATE","Caption","Due Date")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","COMPLDATE","Caption","Compl. Date")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","CODE_SORT_OPER","Caption","Sort Code")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","OVERLAP","Caption","Overlap")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","NOMACH","Caption","WC Factor")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","FLOAT","Caption","Float")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","EST_HRS","Caption","Est. Hrs.")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","ACT_HRS","Caption","Act. Hrs.")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","REM_HRS","Caption","Rem. Hrs.")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","ORDER_QTY","Caption","Order Qty.")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","COMPL_QTY","Caption","Comp. Qty.")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","PCS_REM","Caption","Rem. Qty.")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","SEQ","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","SEQRES","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","DESCR","MinWidth","200")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","STARTDATE","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","DUEDATE","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","COMPLDATE","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","CODE_SORT_OPER","MinWidth","100")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","OVERLAP","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","NOMACH","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","FLOAT","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","EST_HRS","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","ACT_HRS","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","REM_HRS","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","ORDER_QTY","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","COMPL_QTY","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","PCS_REM","MinWidth","75")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","SEQ","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","STARTDATE","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","DUEDATE","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","COMPLDATE","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","OVERLAP","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","NOMACH","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","FLOAT","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","EST_HRS","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","ACT_HRS","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","REM_HRS","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","ORDER_QTY","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","COMPL_QTY","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","PCS_REM","HeaderHAlignment","Center")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","SEQ","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","STARTDATE","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","DUEDATE","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","COMPLDATE","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","OVERLAP","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","NOMACH","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","FLOAT","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","EST_HRS","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","ACT_HRS","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","REM_HRS","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","ORDER_QTY","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","COMPL_QTY","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","PCS_REM","CellHAlignment","Center")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","SEQ","Fixed","Left")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","SEQRES","CellTrimming","Character")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","STARTDATE","DisplayCustomDatetime","d")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","DUEDATE","DisplayCustomDatetime","d")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvLbr","COMPLDATE","DisplayCustomDatetime","d")
	
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtWOs$dtLbr.RowCount--,1)
		Function.Intrinsic.Math.Mod(V.Local.iCnt,2,V.Local.iRet)
		Function.Intrinsic.Control.If(V.Local.iRet,=,0)
			Gui.F_WO.GsGCWO.SetRowAppearance("gvLbr",V.Local.iCnt,"BackColor","AliceBlue")
		Function.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)
	Gui.F_WO.GsGCWO.ResumeLayout()
Program.Sub.LoadDTDVGVLbr.End

Program.Sub.LoadDTDVGVOut.Start
	V.Local.iRet.Declare
	V.Local.iCnt.Declare
	F.Intrinsic.Control.If(v.DataTable.dtWOs$dtOut.Exists, =, True)
		F.Data.DataTable.Close("dtWOs$dtOut")
	F.Intrinsic.Control.EndIf
	
	
	F.Data.DataTable.CreateFromSQL("dtWOs$dtOut","con","SELECT DISTINCT CONCAT(A.JOB,A.SUFFIX) AS JBSF,CONCAT(CONCAT(A.JOB,A.SUFFIX),A.SEQ) AS JSS,A.JOB,A.SUFFIX,A.SEQ,C.NAME_VENDOR,E.PURCHASE_ORDER as PURCHASE_ORDER1,B.PCSREMAIN,B.DESCR,B.STARTDATE,B.DUEDATE,B.COMPLDATE,  IF(E.Flag_Recv_Close = 'Y', 1,0) as Flag_Recv_Close FROM JOB_OPERATIONS A LEFT JOIN APSV3_JBLINES B ON JSS = B.JSS LEFT JOIN V_VENDOR_MASTER C ON B.OPCODE = C.VENDOR LEFT JOIN V_PO_LINES E ON A.JOB = E.JOB AND A.SUFFIX = E.SUFFIX  AND A.SEQ = E.SEQUENCE WHERE A.LMO = 'O' AND A.SEQ <> '997000' AND JBSF IN (SELECT CONCAT(JOB,SUFFIX) AS JBSFX FROM V_JOB_HEADER WHERE DATE_CLOSED = '1900-1-1') ORDER BY A.JOB,A.SUFFIX,A.SEQ;",True)
	F.Data.DataTable.AddColumn("dtWOs$dtOut", "WODate", "Date")
	F.Data.Dictionary.CreateFromSQL("dictDate","con","SELECT DISTINCT (A.JOB+A.SUFFIX) AS JBSF, A.Date_Due from v_Job_Header A")
	F.Data.Dictionary.SetDefaultReturn("dictDate", "1/1/1900")
	F.Data.DataTable.FillFromDictionary("dtWOs$dtOut", "dictDate", "JBSF", "WODate")
	F.Data.Dictionary.Close("dictDate")
	
	F.Data.DataTable.AddColumn("dtWOs$dtOut", "Late", "String")
	F.Data.DataView.Create("dtWOs$dtOut", "dvLate", 22, "DUEDATE>=WODate AND FLAG_RECV_Close <> 1 AND PURCHASE_ORDER1 <> ''",)
	F.Data.DataView.SetValue("dtWOs$dtOut", "dvLate",-1, "Late", "Y")
	F.Data.DataView.Close("dtWOs$dtOut", "dvLate")
	F.Data.DataTable.AddExpressionColumn("dtWOs$dtOut", "Flag_Recv_Close2", "Long", "IIF(Late = 'Y', '1', '0')")
	
	
	F.Data.DataTable.AddRelation("dtWOs","JS","dtWOs$dtOut","JBSF","Outside")
	
	F.Data.DataTable.AddExpressionColumn("dtWOs", "PODate", "Date", "Min(Child(Outside).DueDate)")
	F.Data.DataTable.AddExpressionColumn("dtWOs", "POClose", "String", "Max(Child(Outside).Flag_Recv_Close2)")	
	F.Data.DataView.Create("dtWOs", "dvLate", 22, "Date_Due<=PODate AND POClose = 1",)
	F.Data.DataView.SetValue("dtWOs", "dvLate",-1, "Late", "Y")
	F.Data.DataView.Close("dtWOs", "dvLate")
	
	F.Data.DataView.Create("dtWOs", "dvLate", 22, "Late = 'Y'", )
	F.Data.Dictionary.CreateFromDataView("Parent", "dtWOs","dvLate", "Parent", "Late")
	F.Data.Dictionary.SetDefaultReturn("Parent", "")
	F.Data.DataTable.FillFromDictionary("dtWOs", "Parent", "JS", "ParentLate")
	F.Data.Dictionary.Close("Parent")
	F.Data.DataView.Close("dtWOs", "dvLate")
	
	F.Data.DataView.Create("dtWOs$dtOut","dvOut")
	
	gui.F_WO.GsGCWO.SetColumnProperty("gvWOs", "Late", "Visible", False)
	gui.F_WO.GsGCWO.SetColumnProperty("gvWOs", "Parent", "Visible", False)
	gui.F_WO.GsGCWO.SetColumnProperty("gvWOs", "ParentLate", "Visible", False)
	
	Gui.F_WO.GsGCWO.AddGridViewFromDataView("gvOut","dtWOs","dvOut")
	
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvOut","MultiSelect",True)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvOut","OptionBehaviorEditable",False)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvOut","ReadOnly",True)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvOut","AllowSort",True)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvOut","AllowFilter",True)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvOut","OptionsDetailShowDetailTabs",False)
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvOut","OptionsViewShowGroupPanel",False)
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","JBSF","Visible",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","JSS","Visible",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","JOB","Visible",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","SUFFIX","Visible",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","Flag_Recv_Close","Visible",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","Late","Visible",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","WODate","Visible",False)
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","Flag_Recv_Close2","Visible",False)
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","SEQ","Caption","Seq ")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","NAME_VENDOR","Caption","Vend. Name")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","PURCHASE_ORDER1","Caption","PO")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","PCSREMAIN","Caption","Qty. Rem.")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","DESCR","Caption","Description")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","STARTDATE","Caption","Start Date")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","DUEDATE","Caption","Due Date")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","COMPLDATE","Caption","Comp. Date")
		
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","SEQ","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","NAME_VENDOR","MinWidth","175")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","PURCHASE_ORDER1","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","PCSREMAIN","MinWidth","75")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","DESCR","MinWidth","200")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","STARTDATE","MinWidth","100")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","DUEDATE","MinWidth","100")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","COMPLDATE","MinWidth","100")	
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","SEQ","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","STARTDATE","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","DUEDATE","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","COMPLDATE","HeaderHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","PCSREMAIN","HeaderHAlignment","Center")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","SEQ","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","STARTDATE","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","DUEDATE","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","COMPLDATE","CellHAlignment","Center")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","PCSREMAIN","CellHAlignment","Center")
		
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","SEQ","Fixed","Left")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","STARTDATE","DisplayCustomDatetime","d")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","DUEDATE","DisplayCustomDatetime","d")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","COMPLDATE","DisplayCustomDatetime","d")
	
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","PURCHASE_ORDER1","CellForeColor","Blue")
	Gui.F_WO.GsGCWO.SetColumnProperty("gvOut","PURCHASE_ORDER1","CellFontUnderline",True)

	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtWOs$dtOut.RowCount--,2)
		Gui.F_WO.GsGCWO.SetRowAppearance("gvOut",V.Local.iCnt,"BackColor","AliceBlue")
	F.Intrinsic.Control.Next(V.Local.iCnt)
	Gui.F_WO.GsGCWO.ResumeLayout()
Program.Sub.LoadDTDVGVOut.End

Program.Sub.CheckTable.Start
	V.Local.bExists.Declare(Boolean)
	
	Gui.F_WO.lblStatus.Caption("Checking Database Table....")
	
	F.ODBC.Connection!con.TableExists("GAB_4135_WO_NOTES",V.Local.bExists)
	F.Intrinsic.Control.If(V.Local.bExists,=,False)
		F.ODBC.Connection!con.Execute("CREATE TABLE GAB_4135_WO_NOTES(JS CHAR(9) NOT NULL,JOB CHAR(6),SUFFIX CHAR(3),NOTES LONGVARCHAR,PRIMARY KEY (JS));")
		F.ODBC.Connection!con.Execute("CREATE INDEX GAB_4135_WO_NOTES01 USING 1 ON GAB_4135_WO_NOTES(JOB);")
		F.ODBC.Connection!con.Execute("CREATE INDEX GAB_4135_WO_NOTES02 USING 2 ON GAB_4135_WO_NOTES(SUFFIX);")
	F.Intrinsic.Control.EndIf
Program.Sub.CheckTable.End

Program.Sub.Update_FLAG_WO_PRTD.Start
	V.Local.sSQL.Declare
	V.Local.sRet.Declare
	
	F.Intrinsic.String.Build("SELECT FLAG_WO_PRTD FROM V_JOB_HEADER WHERE JOB = '{0}' AND SUFFIX = '{1}';",V.Args.JOB,V.Args.SUFFIX,V.Local.sSQL)
	F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQL,V.Local.sRet)
	Function.Intrinsic.Control.SelectCase(V.Local.sRet)
		Function.Intrinsic.Control.Case("")
			Function.Intrinsic.String.Build("UPDATE JOB_HEADER SET FLAG_WO_PRTD = 'X' WHERE JOB = '{0}' AND SUFFIX = '{1}';",V.Args.JOB,V.Args.SUFFIX,V.Local.sSQL)
			F.ODBC.Connection!con.Execute(V.Local.sSQL)
		Function.Intrinsic.Control.Case("Y")
			Function.Intrinsic.String.Build("UPDATE JOB_HEADER SET FLAG_WO_PRTD = 'R' WHERE JOB = '{0}' AND SUFFIX = '{1}';",V.Args.JOB,V.Args.SUFFIX,V.Local.sSQL)
			F.ODBC.Connection!con.Execute(V.Local.sSQL)
	Function.Intrinsic.Control.EndSelect
Program.Sub.Update_FLAG_WO_PRTD.End

Program.Sub.cmdExport_Click.Start
	V.Local.sFileExport.Declare
	V.Local.bExcel.Declare
	V.Local.bFileLocked.Declare
	V.Local.sMsg.Declare
	
	F.Automation.MSExcel.CheckPresence(V.Local.bExcel)
	F.Intrinsic.Control.If(V.Local.bExcel)
			F.Intrinsic.String.Build("{0}\GAB_4135_Export.xlsx",V.Caller.LocalGssTempDir,V.Local.sFileExport)
			F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
			F.Intrinsic.Control.If(V.Local.bFileLocked)
				F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
				F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
			F.Intrinsic.Control.Else
				Gui.F_WO.GsGCWO.Export(V.Local.sFileExport,"xlsx")
				F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("{0}\GAB_4135_Export.csv",V.Caller.LocalGssTempDir,V.Local.sFileExport)
			F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
			F.Intrinsic.Control.If(V.Local.bFileLocked)
				F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
				F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
			F.Intrinsic.Control.Else
				Gui.F_WO.GsGCWO.Export(V.Local.sFileExport,"csv")
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
		F.Intrinsic.Control.EndIf
Program.Sub.cmdExport_Click.End

Program.Sub.picGSSLogo_DblClick.Start
	Gui.frmWeb..Show
Program.Sub.picGSSLogo_DblClick.End

Program.Sub.frmWeb_UnLoad.Start
	Gui.frmWeb..Visible(False)
Program.Sub.frmWeb_UnLoad.End

Program.Sub.cmdGSS_Click.Start
	F.Intrinsic.Task.ShellExec(0,"Open","http://www.globalshopsolutions.com/","","",0)
Program.Sub.cmdGSS_Click.End

Program.Sub.cmdServ_Click.Start
	F.Intrinsic.Task.ShellExec(0,"Open","http://gss-service.com/","","",0)
Program.Sub.cmdServ_Click.End

Program.Sub.cmdUpd_Click.Start
	F.Intrinsic.Task.ShellExec(0,"Open","http://gss-updates.com/","","",0)
Program.Sub.cmdUpd_Click.End

Program.Sub.cmdPrint_Click.Start
F.Intrinsic.Control.SetErrorHandler("frmWeb_UnLoad_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

gui.F_WO..Visible(false)
gui.frmEntry..Visible(true)
gui.frmEntry..Show 

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("frmWeb_UnLoad_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GAB_4135_PM_WO_Status.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf


Program.Sub.cmdPrint_Click.End

Program.Sub.cmdOk_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdUpd_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


v.Local.iFor.Declare(long)
v.Local.lQty.Declare(long)
v.Local.sJob.Declare(string)
v.Local.sSufx.Declare(string)
v.Local.sSQL.Declare(string)
V.Local.spackparams.Declare(String)
V.Local.ddate.Declare(String)
V.Local.sProject.Declare(String)
V.Local.sParts.Declare(String)
V.Local.sLoc.Declare(String)
V.Local.sDescr.Declare(String)
V.Local.sNotes.Declare(String)

V.Local.ShipToLoc.Declare(String)
V.Local.ShipDate.Declare(Date)
V.Local.Shipping_Rep.Declare(String)
V.Local.CustomerPO.Declare(String)
V.Local.Mark_Shipment.Declare(String)
V.Local.Shipped_Via.Declare(String)
V.Local.Cartons.Declare(float)
V.Local.Weight.Declare(float)
V.Local.Waybill_Number.Declare(String)
V.Local.Pklst.Declare(String)
V.Local.Comments.Declare(String)

V.Local.sCustom.Declare(string)
V.Local.BiRunID.Declare(long)
V.Local.iBILogID.Declare(long)
v.Local.iRptID.Declare(long)
V.Local.iret.Declare(long)

V.Local.bEnt.Declare(Boolean)

V.Local.ShipToLoc.Set(v.Screen.frmEntry!ddlShipto.Text)
f.Intrinsic.Control.If(V.Local.ShipToLoc,=,"")
	f.Intrinsic.UI.Msgbox("Invalid selection, select ShipTo")
	gui.frmEntry.ddlShipto.SetFocus 
	f.Intrinsic.Control.exitsub
f.Intrinsic.Control.EndIf 

V.Local.ShipDate.set(v.Screen.frmEntry!dtShipdt.Value)
V.Local.Shipping_Rep.Set(v.Screen.frmEntry!txtShipRep.text)
V.Local.CustomerPO.Set(v.Screen.frmEntry!txtCustPO.text)
V.Local.Mark_Shipment.Set(v.Screen.frmEntry!txtMarkShip.text)
V.Local.Shipped_Via.Set(v.Screen.frmEntry!txtshipVia.text)
V.Local.Cartons.Set(v.Screen.frmEntry!txtCartons.text)
V.Local.Weight.Set(v.Screen.frmEntry!txtWt.text)
V.Local.Waybill_Number.Set(v.Screen.frmEntry!txtWaybill.text)
V.Local.Pklst.Set(v.Screen.frmEntry!txtPklst.text)
V.Local.Comments.Set(v.Screen.frmEntry!txtcomments.text)

'v.Local.ddate.Set(v.ambient.Date)
'F.Intrinsic.string.Replace(V.Local.ddate,"-","",V.Local.ddate)

Function.Intrinsic.UI.InvokeWaitDialog("Updating records please wait ...")


F.Intrinsic.Control.For(v.Local.iFor,0,v.dataTable.dtWOs.RowCount--,1)
	v.Local.lQty.Set(V.datatable.dtWOs(v.Local.iFor).Qty_To_Ship.fieldval)
	f.Intrinsic.Control.If(v.Local.lQty,<>,0)
	
		'Initilize only once
		f.Intrinsic.Control.If(V.Local.bEnt,=,False)
			F.Intrinsic.String.Build("{0}\custom\GCG_4253_PMWO_BI.rpt",V.Caller.BusintDir,V.Local.sCustom)
			F.Global.BI.InitializeReport("GCG_4253_PMWO_BI",V.Local.sCustom,V.Local.iRptID)
			F.Global.BI.GetRunID(V.local.BiRunID)
			f.Global.BI.StartLogging(v.Local.BiRunID,v.Local.iRptID,-1,"",V.Local.iBILogID)
			v.Local.sProject.Set(V.datatable.dtWOs(v.Local.iFor).Project.fieldval)
		f.Intrinsic.Control.EndIf
		
		'Restrict only one Project per Print
		f.Intrinsic.Control.If(v.Local.sProject.trim,=,V.datatable.dtWOs(v.Local.iFor).Project.fieldvaltrim)
			V.Local.bEnt.Set(True)
			v.Local.sJob.Set(V.datatable.dtWOs(v.Local.iFor).Job.fieldval)
			v.Local.sSufx.Set(V.datatable.dtWOs(v.Local.iFor).Suffix.fieldval)
			v.Local.sProject.Set(V.datatable.dtWOs(v.Local.iFor).Project.fieldval)
			v.Local.sParts.Set(V.datatable.dtWOs(v.Local.iFor).Part.fieldval)
			v.Local.sLoc.Set(V.datatable.dtWOs(v.Local.iFor).LOCATION.fieldval)
			V.Local.sDescr.Set(V.datatable.dtWOs(v.Local.iFor).DESCRIPTION.fieldval)
			V.Local.sNotes.Set(V.DataTable.dtWOs(V.Local.iFor).DashNotes.FieldVal)
			
			f.Intrinsic.String.Build("select * from GCG_4253_ShipDash where job='{0}' and suffix='{1}' and part='{2}' and loc='{3}' and project = '{4}'",v.Local.sJob,v.Local.sSufx,v.Local.sParts,v.Local.sLoc,v.Local.sProject,v.Local.sSQL)
				F.ODBC.Connection!con.openlocalrecordsetrw("rst",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rst.EOF,=,True)
				f.ODBC.con!rst.AddNew
				F.ODBC.con!rst.Set!Job(v.Local.sJob)
				F.ODBC.con!rst.Set!Suffix(v.Local.sSufx)
				F.ODBC.con!rst.Set!Project(v.Local.sProject)
				F.ODBC.con!rst.Set!Phase(V.datatable.dtWOs(v.Local.iFor).Phase.fieldval)
				v.Local.lQty.Set(V.datatable.dtWOs(v.Local.iFor).Qty_To_Ship.fieldval)
				F.ODBC.con!rst.Set!Qty_Shipped(v.Local.lQty)
				F.ODBC.con!rst.Set!Part(v.Local.sParts)
				F.ODBC.con!rst.Set!Loc(v.Local.sLoc)
				F.ODBC.con!rst.Set!Notes(V.Local.sNotes.Trim)
			f.Intrinsic.Control.Else
				f.Intrinsic.Math.Add(V.datatable.dtWOs(v.Local.iFor).Qty_Shipped.fieldval,V.datatable.dtWOs(v.Local.iFor).Qty_To_Ship.fieldval,v.Local.lQty)
				F.ODBC.con!rst.Set!Qty_Shipped(v.Local.lQty)
				F.ODBC.con!rst.Set!Notes(V.Local.sNotes.Trim)
				f.Intrinsic.Control.EndIf 
			f.ODBC.con!rst.Update
			f.ODBC.con!rst.Close 
			
			
			V.Local.sSQL.Set("Insert Into GCG_4253_PMWO_BI (Project,Part,Loc,Descr,ShipToLoc,ShipDate,Shipping_Rep,CustomerPO,Mark_Shipment,Shipped_Via,Cartons,Weight,Waybill_Number,RUNID,Qty_Ship,Pklst_No,Comments) values")
			f.Intrinsic.String.Build("{0} ('{1}','{2}','{3}','{4}','{5}','{6}','{7}','{8}','{9}','{10}',{11},{12},'{13}',{14},{15},'{16}','{17}')",V.Local.sSQL,v.Local.sProject,v.Local.sParts ,v.Local.sLoc,v.Local.sDescr,v.Local.ShipToLoc,v.Local.ShipDate.PervasiveDate,v.Local.Shipping_Rep,v.Local.CustomerPO,v.Local.Mark_Shipment,v.Local.Shipped_Via,v.Local.Cartons.Float ,v.Local.Weight.Float,v.Local.Waybill_Number,V.local.BiRunID,V.datatable.dtWOs(v.Local.iFor).Qty_To_Ship.fieldval,V.Local.Pklst.trim,V.Local.Comments.trim,V.Local.sSQL)
			f.ODBC.Connection!con.Execute(V.Local.sSQL)
			
			F.Data.DataTable.SetValue("dtWOs",v.Local.iFor,"Qty_To_Ship",0)
			F.Data.DataTable.SetValue("dtWOs",v.Local.iFor,"Qty_Shipped",v.Local.lQty)
		Function.Intrinsic.Control.EndIf
	Function.Intrinsic.Control.EndIf
	
f.Intrinsic.Control.Next(v.Local.iFor)

Function.Intrinsic.UI.InvokeWaitDialog("Printing please wait ...")
f.Intrinsic.Control.If(V.Local.bEnt,=,True)
	F.Global.BI.StopLogging(V.Local.iBILogID)
	F.Global.BI.RunReportPreProcessor(V.local.BiRunID,V.local.iBILogID,"","","",-1,True,"",-1,"",-1,"","",V.Local.iret)
	f.Intrinsic.String.Build("delete from GCG_4253_PMWO_BI where RUNID = {0}",V.local.BiRunID,V.Local.sSQL)
	f.ODBC.Connection!con.Execute(V.Local.sSQL)
f.Intrinsic.Control.EndIf
Function.Intrinsic.UI.CloseWaitDialog

gui.frmEntry..Visible(False)
Gui.frmEntry..ClearGroup(0)
gui.F_WO..Visible(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdUpd_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.UI.CloseWaitDialog
	Function.Intrinsic.String.Concat("Project: GAB_4135_PM_WO_Status.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf


Program.Sub.cmdOk_Click.End

Program.Sub.frmEntry_UnLoad.Start
F.Intrinsic.Control.SetErrorHandler("cmdOk_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

gui.frmEntry..Visible(False)
gui.F_WO..Visible(True)



F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdOk_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GAB_4253_PMWO_Status.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf


Program.Sub.frmEntry_UnLoad.End

Program.Sub.cmdClrFlt_Click.Start
	Gui.F_WO.GsGCWO.SetGridViewProperty("gvWOs","ActiveFilterString","")
Program.Sub.cmdClrFlt_Click.End

Program.Sub.cmdSrtWoSuf_Click.Start
	F.Intrinsic.Control.If(V.DataView.dtWOs!dvWOs.Exists)
'		gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","JOB","SortOrder","")
'		gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","SUFFIX","SortOrder","")
'		gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PART","SortOrder","")
'		F.Data.DataView.SetSort("dtWOs","dvWOs","JOB ASC, SUFFIX ASC")
'		gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PART","SortOrder","")
'		gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PART","SortOrder","None")
'		gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","PART","SortOrder","0")
		Gui.F_WO.GsGCWO.ClearSorting("gvWOs")
		gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","JOB","SortOrder","Ascending")
		gui.F_WO.GsGCWO.SetColumnProperty("gvWOs","SUFFIX","SortOrder","Ascending")
	F.Intrinsic.Control.EndIf
Program.Sub.cmdSrtWoSuf_Click.End

Program.Sub.CmdClrSrt_Click.Start
Gui.F_WO.GsGCWO.ClearSorting("gvWOs")
Program.Sub.CmdClrSrt_Click.End

Program.Sub.cmd1_Click.Start
v.Local.iCount.Declare
v.Local.sSql.Declare
v.Local.sDate.Declare
v.Local.sMonth.Declare
v.Local.sDay.Declare
v.Local.sYear.Declare
F.Intrinsic.Control.BlockEvents
'Loop through the array of indexs and reschedule
gui.F_WO.lblStatus.Visible(True)
gui.F_WO.lblStatus.text("Rescheduling Jobs....")
F.Intrinsic.Control.If(v.Global.sOrdinal(0).Trim, !=, "")
	F.Intrinsic.Control.For(v.Local.iCount, 0, v.Global.sOrdinal.UBound, 1)
		F.Global.APS.ScheduleJob(v.DataTable.dtWOs(v.Global.sOrdinal(v.Local.iCount)).Job!FieldValTrim,v.DataTable.dtWOs(v.Global.sOrdinal(v.Local.iCount)).Suffix!FieldValTrim, "B",v.DataTable.dtWOs(v.Global.sOrdinal(v.Local.iCount)).Date_Due!FieldVal)
		F.Intrinsic.String.Build("Select Date_Due from Job_Header where Job = '{0}' and Suffix = '{1}'", v.DataTable.dtWOs(v.Global.sOrdinal(v.Local.iCount)).Job!FieldValTrim,v.DataTable.dtWOs(v.Global.sOrdinal(v.Local.iCount)).Suffix!FieldValTrim, v.Local.sSql)
		F.ODBC.Connection!con.openlocalrecordsetRW("Job", v.Local.sSql)
		F.Intrinsic.Control.If(v.ODBC.con!Job.EOF, =, False)
			F.Intrinsic.Date.Month(v.DataTable.dtWOs(v.Global.sOrdinal(v.Local.iCount)).Date_Due!FieldVal, v.Local.sMonth)
			F.Intrinsic.String.LPad(v.Local.sMonth, "0", 2, v.Local.sMonth)
			F.Intrinsic.Date.Day(v.DataTable.dtWOs(v.Global.sOrdinal(v.Local.iCount)).Date_Due!FieldVal, v.Local.sDay)
			F.Intrinsic.String.LPad(v.Local.sDay, "0", 2, v.Local.sDay)
			f.Intrinsic.Date.Year(v.DataTable.dtWOs(v.Global.sOrdinal(v.Local.iCount)).Date_Due!FieldVal, v.Local.sYear)
			f.Intrinsic.String.Right(v.Local.sYear, 2,v.Local.sDate)
			F.Intrinsic.String.Build("{0}{1}{2}", v.Local.sMonth, v.Local.sDay, v.Local.sDate, v.Local.sDate)
			f.ODBC.con!Job.Set!Date_Due(v.Local.sDate)
			f.ODBC.con!Job.Update
		F.Intrinsic.Control.EndIf
		f.ODBC.con!Job.Close
	F.Intrinsic.Control.Next(v.Local.iCount)

	F.Intrinsic.Control.CallSub(lockscreen)
	F.Intrinsic.Control.CallSub(checktable)
	F.Intrinsic.Control.CallSub(loaddtdvwos)
	F.Intrinsic.Control.CallSub(loadgvwos)
	F.Intrinsic.Control.CallSub(loaddtdvgvmatl)
	F.Intrinsic.Control.CallSub(loaddtdvgvlbr)
	F.Intrinsic.Control.CallSub(loaddtdvgvout)
'	F.Intrinsic.Control.CallSub(loadtotals,"Filter","JOB LIKE '%%'")
	'Remove indirect Jobs
	F.Intrinsic.Control.CallSub(loadtotals,"Filter","JOB LIKE '%%' AND IND_FLAG <> True")
	f.Intrinsic.Control.CallSub(update_status)
	F.Intrinsic.Control.CallSub(Formatting)
	F.Intrinsic.Control.CallSub(enablescreen)
F.Intrinsic.Control.EndIf
gui.F_WO.lblStatus.Text("")
gui.F_WO.lblStatus.Visible(False)
F.Intrinsic.Control.UnBlockEvents
Program.Sub.cmd1_Click.End

Program.Sub.Formatting.Start
	gui.F_WO.GsGCWO.AddStyleFormatCondition("gvOut", "Late", "Color1", "Equal", "Y")
	gui.F_WO.GsGCWO.SetStyleFormatConditionProperty("gvOut", "Late", "Color1", "BackColor", "Salmon")
	gui.F_WO.GsGCWO.SetStyleFormatConditionProperty("gvOut", "Late", "Color1", "ApplyToRow", True)
	
	gui.F_WO.GsGCWO.AddStyleFormatCondition("gvWOs", "Late", "Color2", "Equal", "Y")
	gui.F_WO.GsGCWO.SetStyleFormatConditionProperty("gvWOs", "Late", "Color2", "BackColor", "Salmon")
	gui.F_WO.GsGCWO.SetStyleFormatConditionProperty("gvWOs", "Late", "Color2", "ApplyToRow", True)
	
	gui.F_WO.GsGCWO.AddStyleFormatCondition("gvWOs", "ParentLate", "Color3", "Equal", "Y")
	gui.F_WO.GsGCWO.SetStyleFormatConditionProperty("gvWOs", "ParentLate", "Color3", "BackColor", "Salmon")
	gui.F_WO.GsGCWO.SetStyleFormatConditionProperty("gvWOs", "ParentLate", "Color3", "ApplyToRow", True)
Program.Sub.Formatting.End

Program.Sub.Serialize.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSerialize.Declare
	
	'gvWOs
	Gui.F_WO.GsGCWO.Serialize("gvWOs",V.Local.sSerialize)
	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVWOS",4135,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.Serialize.End

Program.Sub.Deserialize.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSerialize.Declare
	
	'Delete old registry records
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVWOS",4135,0,5,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize,<>,"")
		F.ODBC.Connection!common.OpenConnection(V.Ambient.Ccon,V.Ambient.Cuser,V.Ambient.Cpass)
		F.ODBC.Connection!common.Execute("Delete From Gs_Registry Where Reg_ID = 4135 And Seq < 1000;")
		F.ODBC.Connection!common.Close
	F.Intrinsic.Control.EndIf

	'gvWOs
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVWOS",4135,1000,6,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize,<>,"")
		Gui.F_WO.GsGCWO.Deserialize(V.Local.sSerialize)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.Deserialize.End

Program.Sub.Comments.Start
${$0$}$GAB_4135_PM_WO_Status.g2u$}$AGV$}$6/2/2016 8:34:18 AM$}$False
${$3$}$0$}$$}$0$}$-1$}$$}$12:00:00 AM$}$Modification of ARC Project 1507 original program GCG_6963-2_Multi_MRP.gas
This adds in the ability to save the Summary for later use.
Program.Sub.Comments.End
